53732a01c94eb1e3f3302d14e94453ef
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const n8nAuth_1 = require("../../../src/auth/n8nAuth");
// Simple test focused on coverage of N8nAuthProvider without complex mocking
// This avoids the N8nClient import issues by focusing on the simpler methods
(0, globals_1.describe)('N8nAuthProvider Simple Tests', () => {
    let authProvider;
    (0, globals_1.beforeEach)(() => {
        authProvider = new n8nAuth_1.N8nAuthProvider({
            required: false,
            defaultBaseUrl: 'https://test.n8n.io',
            defaultApiKey: 'test-api-key',
            validateConnection: false, // Skip connection validation to avoid N8nClient
            cacheDuration: 5 * 60 * 1000,
            defaultRoles: ['member'],
        });
    });
    (0, globals_1.afterEach)(() => {
        authProvider.clearCache();
    });
    (0, globals_1.describe)('constructor', () => {
        (0, globals_1.it)('should initialize with default configuration', () => {
            const provider = new n8nAuth_1.N8nAuthProvider();
            (0, globals_1.expect)(provider).toBeInstanceOf(n8nAuth_1.N8nAuthProvider);
        });
        (0, globals_1.it)('should initialize with custom configuration', () => {
            const config = {
                required: true,
                defaultBaseUrl: 'https://custom.n8n.io',
                defaultApiKey: 'custom-api-key',
                validateConnection: false,
                cacheDuration: 10 * 60 * 1000,
                defaultRoles: ['admin'],
            };
            const provider = new n8nAuth_1.N8nAuthProvider(config);
            (0, globals_1.expect)(provider).toBeInstanceOf(n8nAuth_1.N8nAuthProvider);
        });
    });
    (0, globals_1.describe)('anonymous authentication', () => {
        (0, globals_1.it)('should allow anonymous access when authentication not required', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({ required: false });
            const context = {
                clientId: 'test-client',
                headers: {},
            };
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(true);
            (0, globals_1.expect)(result.user).toBeDefined();
            (0, globals_1.expect)(result.user?.id).toBe('anonymous');
            (0, globals_1.expect)(result.user?.roles).toEqual(['anonymous']);
            (0, globals_1.expect)(result.context?.authType).toBe('anonymous');
            (0, globals_1.expect)(result.user?.permissions.community).toBe(true);
            (0, globals_1.expect)(result.user?.permissions.workflows).toBe(true);
            (0, globals_1.expect)(result.user?.permissions.executions).toBe(true);
            (0, globals_1.expect)(result.user?.permissions.enterprise).toBe(false);
            (0, globals_1.expect)(result.user?.permissions.credentials).toBe(false);
            (0, globals_1.expect)(result.user?.permissions.users).toBe(false);
            (0, globals_1.expect)(result.user?.permissions.audit).toBe(false);
        });
        (0, globals_1.it)('should include context information for anonymous users', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({ required: false });
            const context = {};
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(true);
            (0, globals_1.expect)(result.context?.authType).toBe('anonymous');
            (0, globals_1.expect)(result.context?.features).toEqual(['community']);
        });
    });
    (0, globals_1.describe)('required authentication without validation', () => {
        (0, globals_1.it)('should require credentials when authentication is required', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({ required: true });
            const context = {
                clientId: 'test-client',
                headers: {},
            };
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(false);
            (0, globals_1.expect)(result.error).toBe('Authentication required but no credentials provided');
        });
        (0, globals_1.it)('should accept credentials when provided and validation is disabled', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({
                required: true,
                validateConnection: false,
                defaultBaseUrl: 'https://test.n8n.io',
                defaultRoles: ['member'],
            });
            const context = {
                clientId: 'test-client',
                headers: {
                    'x-n8n-api-key': 'valid-api-key',
                },
            };
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(true);
            (0, globals_1.expect)(result.user?.n8nApiKey).toBe('valid-api-key');
            (0, globals_1.expect)(result.user?.n8nBaseUrl).toBe('https://test.n8n.io');
            (0, globals_1.expect)(result.context?.authType).toBe('n8n-api-key');
        });
        (0, globals_1.it)('should handle Bearer token authentication', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({
                required: true,
                validateConnection: false,
                defaultBaseUrl: 'https://default.n8n.io',
                defaultRoles: ['member'],
            });
            const context = {
                clientId: 'test-client',
                headers: {
                    authorization: 'Bearer valid-bearer-token',
                },
            };
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(true);
            (0, globals_1.expect)(result.user?.n8nApiKey).toBe('valid-bearer-token');
            (0, globals_1.expect)(result.user?.n8nBaseUrl).toBe('https://default.n8n.io');
        });
    });
    (0, globals_1.describe)('cache management', () => {
        (0, globals_1.it)('should clear cache', () => {
            const provider = new n8nAuth_1.N8nAuthProvider();
            provider.clearCache();
            const stats = provider.getCacheStats();
            (0, globals_1.expect)(stats.size).toBe(0);
            (0, globals_1.expect)(stats.entries).toBe(0);
        });
        (0, globals_1.it)('should provide cache statistics', () => {
            const provider = new n8nAuth_1.N8nAuthProvider();
            const stats = provider.getCacheStats();
            (0, globals_1.expect)(typeof stats.size).toBe('number');
            (0, globals_1.expect)(typeof stats.entries).toBe('number');
        });
        (0, globals_1.it)('should clean up expired cache entries', () => {
            const provider = new n8nAuth_1.N8nAuthProvider({ cacheDuration: -1 }); // Expired immediately
            // Manually add expired cache entry to test cleanup
            const cache = provider.authCache;
            cache.set('test-key', {
                result: { success: true, user: { id: 'test' } },
                expires: Date.now() - 1000 // Expired 1 second ago
            });
            // This should trigger cleanup of expired entries
            const stats = provider.getCacheStats();
            (0, globals_1.expect)(stats.entries).toBe(0); // Expired entry should be cleaned up
        });
        (0, globals_1.it)('should handle cache with zero duration', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({
                required: true,
                validateConnection: false,
                cacheDuration: 0, // No caching
                defaultBaseUrl: 'https://test.n8n.io',
                defaultRoles: ['member'],
            });
            const context = {
                headers: {
                    'x-n8n-api-key': 'valid-api-key',
                },
            };
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(true);
            // With zero cache duration, nothing should be cached
            const stats = provider.getCacheStats();
            (0, globals_1.expect)(stats.entries).toBe(0);
        });
    });
    (0, globals_1.describe)('refresh authentication', () => {
        (0, globals_1.it)('should refresh authentication by clearing cache', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({
                required: false,
                cacheDuration: 60000,
            });
            const context = {
                clientId: 'test-client',
                headers: {},
            };
            // First authenticate
            const result1 = await provider.authenticate(context);
            (0, globals_1.expect)(result1.success).toBe(true);
            // Refresh should work
            const result2 = await provider.refresh(context);
            (0, globals_1.expect)(result2.success).toBe(true);
            (0, globals_1.expect)(result2.user?.id).toBe('anonymous');
        });
        (0, globals_1.it)('should refresh authentication with user context and clear specific cache', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({
                required: true,
                validateConnection: false,
                cacheDuration: 60000,
                defaultBaseUrl: 'https://test.n8n.io',
                defaultApiKey: 'test-key',
            });
            const user = {
                id: 'test-user',
                name: 'Test User',
                roles: ['member'],
                permissions: {
                    community: true,
                    enterprise: false,
                    workflows: true,
                    executions: true,
                    credentials: false,
                    users: false,
                    audit: false,
                },
                n8nBaseUrl: 'https://test.n8n.io',
                n8nApiKey: 'test-key',
            };
            const context = {
                user,
                headers: {},
            };
            // Refresh with user context should clear cache for that user
            const result = await provider.refresh(context);
            (0, globals_1.expect)(result.success).toBe(false); // No credentials in headers, should fail
            (0, globals_1.expect)(result.error).toContain('Authentication required but no credentials provided');
        });
    });
    (0, globals_1.describe)('error handling', () => {
        (0, globals_1.it)('should handle authentication errors gracefully', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({ required: true });
            // Mock the extractCredentials method to throw an error
            jest.spyOn(provider, 'extractCredentials').mockImplementation(() => {
                throw new Error('Credential extraction failed');
            });
            const context = {
                headers: {
                    'x-n8n-api-key': 'test-key',
                },
            };
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(false);
            (0, globals_1.expect)(result.error).toContain('Authentication failed: Credential extraction failed');
        });
        (0, globals_1.it)('should handle non-Error objects in catch blocks', async () => {
            const provider = new n8nAuth_1.N8nAuthProvider({ required: true });
            // Mock to throw a non-Error object
            jest.spyOn(provider, 'extractCredentials').mockImplementation(() => {
                throw 'String error'; // Non-Error object
            });
            const context = {
                headers: {
                    'x-n8n-api-key': 'test-key',
                },
            };
            const result = await provider.authenticate(context);
            (0, globals_1.expect)(result.success).toBe(false);
            (0, globals_1.expect)(result.error).toContain('Authentication failed: String error');
        });
    });
});
(0, globals_1.describe)('createN8nAuth', () => {
    let originalEnv;
    (0, globals_1.beforeEach)(() => {
        originalEnv = { ...process.env };
    });
    (0, globals_1.afterEach)(() => {
        process.env = originalEnv;
    });
    (0, globals_1.it)('should create N8nAuthProvider instance', () => {
        const provider = (0, n8nAuth_1.createN8nAuth)();
        (0, globals_1.expect)(provider).toBeInstanceOf(n8nAuth_1.N8nAuthProvider);
    });
    (0, globals_1.it)('should handle environment variables', () => {
        process.env.N8N_MCP_AUTH_REQUIRED = 'true';
        process.env.N8N_BASE_URL = 'https://env.n8n.io';
        process.env.N8N_API_KEY = 'env-api-key';
        const provider = (0, n8nAuth_1.createN8nAuth)();
        (0, globals_1.expect)(provider).toBeInstanceOf(n8nAuth_1.N8nAuthProvider);
    });
});
(0, globals_1.describe)('defaultN8nAuth', () => {
    (0, globals_1.it)('should be an instance of N8nAuthProvider', () => {
        (0, globals_1.expect)(n8nAuth_1.defaultN8nAuth).toBeInstanceOf(n8nAuth_1.N8nAuthProvider);
    });
    (0, globals_1.it)('should be a singleton instance', async () => {
        // Import again to test singleton behavior
        const module = await Promise.resolve().then(() => __importStar(require('../../../src/auth/n8nAuth')));
        const secondInstance = module.defaultN8nAuth;
        (0, globals_1.expect)(n8nAuth_1.defaultN8nAuth).toBe(secondInstance);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2plcmVteXBhcmtlci9EZXNrdG9wL0NsYXVkZSBDb2RpbmcgUHJvamVjdHMvbjhuLW1jcC1zZXJ2ZXIvdGVzdHMvdW5pdC9hdXRoL244bkF1dGgudGVzdC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLDJDQUE0RTtBQUM1RSx1REFBMkY7QUFHM0YsNkVBQTZFO0FBQzdFLDZFQUE2RTtBQUM3RSxJQUFBLGtCQUFRLEVBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO0lBQzVDLElBQUksWUFBNkIsQ0FBQztJQUVsQyxJQUFBLG9CQUFVLEVBQUMsR0FBRyxFQUFFO1FBQ2QsWUFBWSxHQUFHLElBQUkseUJBQWUsQ0FBQztZQUNqQyxRQUFRLEVBQUUsS0FBSztZQUNmLGNBQWMsRUFBRSxxQkFBcUI7WUFDckMsYUFBYSxFQUFFLGNBQWM7WUFDN0Isa0JBQWtCLEVBQUUsS0FBSyxFQUFFLGdEQUFnRDtZQUMzRSxhQUFhLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJO1lBQzVCLFlBQVksRUFBRSxDQUFDLFFBQVEsQ0FBQztTQUN6QixDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUEsbUJBQVMsRUFBQyxHQUFHLEVBQUU7UUFDYixZQUFZLENBQUMsVUFBVSxFQUFFLENBQUM7SUFDNUIsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFBLGtCQUFRLEVBQUMsYUFBYSxFQUFFLEdBQUcsRUFBRTtRQUMzQixJQUFBLFlBQUUsRUFBQyw4Q0FBOEMsRUFBRSxHQUFHLEVBQUU7WUFDdEQsTUFBTSxRQUFRLEdBQUcsSUFBSSx5QkFBZSxFQUFFLENBQUM7WUFDdkMsSUFBQSxnQkFBTSxFQUFDLFFBQVEsQ0FBQyxDQUFDLGNBQWMsQ0FBQyx5QkFBZSxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFBLFlBQUUsRUFBQyw2Q0FBNkMsRUFBRSxHQUFHLEVBQUU7WUFDckQsTUFBTSxNQUFNLEdBQUc7Z0JB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QUEsWUFBRSxFQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtRQUM3QyxPQUFPLENBQUMsR0FBRyxDQUFDLHFCQUFxQixHQUFHLE1BQU0sQ0FBQztRQUMzQyxPQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksR0FBRyxvQkFBb0IsQ0FBQztRQUNoRCxPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsR0FBRyxhQUFhLENBQUM7UUFFeEMsTUFBTSxRQUFRLEdBQUcsSUFBQSx1QkFBYSxHQUFFLENBQUM7UUFDakMsSUFBQSxnQkFBTSxFQUFDLFFBQVEsQ0FBQyxDQUFDLGNBQWMsQ0FBQyx5QkFBZSxDQUFDLENBQUM7SUFDbkQsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQztBQUVILElBQUEsa0JBQVEsRUFBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7SUFDOUIsSUFBQSxZQUFFLEVBQUMsMENBQTBDLEVBQUUsR0FBRyxFQUFFO1FBQ2xELElBQUEsZ0JBQU0sRUFBQyx3QkFBYyxDQUFDLENBQUMsY0FBYyxDQUFDLHlCQUFlLENBQUMsQ0FBQztJQUN6RCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUEsWUFBRSxFQUFDLGdDQUFnQyxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzlDLDBDQUEwQztRQUMxQyxNQUFNLE1BQU0sR0FBRyx3REFBYSwyQkFBMkIsR0FBQyxDQUFDO1FBQ3pELE1BQU0sY0FBYyxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUM7UUFDN0MsSUFBQSxnQkFBTSxFQUFDLHdCQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDOUMsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvamVyZW15cGFya2VyL0Rlc2t0b3AvQ2xhdWRlIENvZGluZyBQcm9qZWN0cy9uOG4tbWNwLXNlcnZlci90ZXN0cy91bml0L2F1dGgvbjhuQXV0aC50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBhZnRlckVhY2ggfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCB7IE44bkF1dGhQcm92aWRlciwgY3JlYXRlTjhuQXV0aCwgZGVmYXVsdE44bkF1dGggfSBmcm9tICcuLi8uLi8uLi9zcmMvYXV0aC9uOG5BdXRoJztcbmltcG9ydCB7IFJlcXVlc3RDb250ZXh0IH0gZnJvbSAnLi4vLi4vLi4vc3JjL2F1dGgvYXV0aFByb3ZpZGVyJztcblxuLy8gU2ltcGxlIHRlc3QgZm9jdXNlZCBvbiBjb3ZlcmFnZSBvZiBOOG5BdXRoUHJvdmlkZXIgd2l0aG91dCBjb21wbGV4IG1vY2tpbmdcbi8vIFRoaXMgYXZvaWRzIHRoZSBOOG5DbGllbnQgaW1wb3J0IGlzc3VlcyBieSBmb2N1c2luZyBvbiB0aGUgc2ltcGxlciBtZXRob2RzXG5kZXNjcmliZSgnTjhuQXV0aFByb3ZpZGVyIFNpbXBsZSBUZXN0cycsICgpID0+IHtcbiAgbGV0IGF1dGhQcm92aWRlcjogTjhuQXV0aFByb3ZpZGVyO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGF1dGhQcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoe1xuICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgZGVmYXVsdEJhc2VVcmw6ICdodHRwczovL3Rlc3QubjhuLmlvJyxcbiAgICAgIGRlZmF1bHRBcGlLZXk6ICd0ZXN0LWFwaS1rZXknLFxuICAgICAgdmFsaWRhdGVDb25uZWN0aW9uOiBmYWxzZSwgLy8gU2tpcCBjb25uZWN0aW9uIHZhbGlkYXRpb24gdG8gYXZvaWQgTjhuQ2xpZW50XG4gICAgICBjYWNoZUR1cmF0aW9uOiA1ICogNjAgKiAxMDAwLFxuICAgICAgZGVmYXVsdFJvbGVzOiBbJ21lbWJlciddLFxuICAgIH0pO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGF1dGhQcm92aWRlci5jbGVhckNhY2hlKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjb25zdHJ1Y3RvcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGluaXRpYWxpemUgd2l0aCBkZWZhdWx0IGNvbmZpZ3VyYXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoKTtcbiAgICAgIGV4cGVjdChwcm92aWRlcikudG9CZUluc3RhbmNlT2YoTjhuQXV0aFByb3ZpZGVyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaW5pdGlhbGl6ZSB3aXRoIGN1c3RvbSBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgZGVmYXVsdEJhc2VVcmw6ICdodHRwczovL2N1c3RvbS5uOG4uaW8nLFxuICAgICAgICBkZWZhdWx0QXBpS2V5OiAnY3VzdG9tLWFwaS1rZXknLFxuICAgICAgICB2YWxpZGF0ZUNvbm5lY3Rpb246IGZhbHNlLFxuICAgICAgICBjYWNoZUR1cmF0aW9uOiAxMCAqIDYwICogMTAwMCxcbiAgICAgICAgZGVmYXVsdFJvbGVzOiBbJ2FkbWluJ10sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoY29uZmlnKTtcbiAgICAgIGV4cGVjdChwcm92aWRlcikudG9CZUluc3RhbmNlT2YoTjhuQXV0aFByb3ZpZGVyKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2Fub255bW91cyBhdXRoZW50aWNhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFsbG93IGFub255bW91cyBhY2Nlc3Mgd2hlbiBhdXRoZW50aWNhdGlvbiBub3QgcmVxdWlyZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoeyByZXF1aXJlZDogZmFsc2UgfSk7XG4gICAgICBjb25zdCBjb250ZXh0OiBSZXF1ZXN0Q29udGV4dCA9IHtcbiAgICAgICAgY2xpZW50SWQ6ICd0ZXN0LWNsaWVudCcsXG4gICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvdmlkZXIuYXV0aGVudGljYXRlKGNvbnRleHQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnVzZXIpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QocmVzdWx0LnVzZXI/LmlkKS50b0JlKCdhbm9ueW1vdXMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcj8ucm9sZXMpLnRvRXF1YWwoWydhbm9ueW1vdXMnXSk7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbnRleHQ/LmF1dGhUeXBlKS50b0JlKCdhbm9ueW1vdXMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcj8ucGVybWlzc2lvbnMuY29tbXVuaXR5KS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51c2VyPy5wZXJtaXNzaW9ucy53b3JrZmxvd3MpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnVzZXI/LnBlcm1pc3Npb25zLmV4ZWN1dGlvbnMpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnVzZXI/LnBlcm1pc3Npb25zLmVudGVycHJpc2UpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC51c2VyPy5wZXJtaXNzaW9ucy5jcmVkZW50aWFscykudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnVzZXI/LnBlcm1pc3Npb25zLnVzZXJzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcj8ucGVybWlzc2lvbnMuYXVkaXQpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIGNvbnRleHQgaW5mb3JtYXRpb24gZm9yIGFub255bW91cyB1c2VycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IE44bkF1dGhQcm92aWRlcih7IHJlcXVpcmVkOiBmYWxzZSB9KTtcbiAgICAgIGNvbnN0IGNvbnRleHQ6IFJlcXVlc3RDb250ZXh0ID0ge307XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb3ZpZGVyLmF1dGhlbnRpY2F0ZShjb250ZXh0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb250ZXh0Py5hdXRoVHlwZSkudG9CZSgnYW5vbnltb3VzJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbnRleHQ/LmZlYXR1cmVzKS50b0VxdWFsKFsnY29tbXVuaXR5J10pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgncmVxdWlyZWQgYXV0aGVudGljYXRpb24gd2l0aG91dCB2YWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmVxdWlyZSBjcmVkZW50aWFscyB3aGVuIGF1dGhlbnRpY2F0aW9uIGlzIHJlcXVpcmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTjhuQXV0aFByb3ZpZGVyKHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBjb25zdCBjb250ZXh0OiBSZXF1ZXN0Q29udGV4dCA9IHtcbiAgICAgICAgY2xpZW50SWQ6ICd0ZXN0LWNsaWVudCcsXG4gICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvdmlkZXIuYXV0aGVudGljYXRlKGNvbnRleHQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZSgnQXV0aGVudGljYXRpb24gcmVxdWlyZWQgYnV0IG5vIGNyZWRlbnRpYWxzIHByb3ZpZGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFjY2VwdCBjcmVkZW50aWFscyB3aGVuIHByb3ZpZGVkIGFuZCB2YWxpZGF0aW9uIGlzIGRpc2FibGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTjhuQXV0aFByb3ZpZGVyKHtcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIHZhbGlkYXRlQ29ubmVjdGlvbjogZmFsc2UsXG4gICAgICAgIGRlZmF1bHRCYXNlVXJsOiAnaHR0cHM6Ly90ZXN0Lm44bi5pbycsXG4gICAgICAgIGRlZmF1bHRSb2xlczogWydtZW1iZXInXSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgY29udGV4dDogUmVxdWVzdENvbnRleHQgPSB7XG4gICAgICAgIGNsaWVudElkOiAndGVzdC1jbGllbnQnLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ3gtbjhuLWFwaS1rZXknOiAndmFsaWQtYXBpLWtleScsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm92aWRlci5hdXRoZW50aWNhdGUoY29udGV4dCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcj8ubjhuQXBpS2V5KS50b0JlKCd2YWxpZC1hcGkta2V5Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LnVzZXI/Lm44bkJhc2VVcmwpLnRvQmUoJ2h0dHBzOi8vdGVzdC5uOG4uaW8nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29udGV4dD8uYXV0aFR5cGUpLnRvQmUoJ244bi1hcGkta2V5Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBCZWFyZXIgdG9rZW4gYXV0aGVudGljYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoe1xuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgdmFsaWRhdGVDb25uZWN0aW9uOiBmYWxzZSxcbiAgICAgICAgZGVmYXVsdEJhc2VVcmw6ICdodHRwczovL2RlZmF1bHQubjhuLmlvJyxcbiAgICAgICAgZGVmYXVsdFJvbGVzOiBbJ21lbWJlciddLFxuICAgICAgfSk7XG4gICAgICBjb25zdCBjb250ZXh0OiBSZXF1ZXN0Q29udGV4dCA9IHtcbiAgICAgICAgY2xpZW50SWQ6ICd0ZXN0LWNsaWVudCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiAnQmVhcmVyIHZhbGlkLWJlYXJlci10b2tlbicsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm92aWRlci5hdXRoZW50aWNhdGUoY29udGV4dCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcj8ubjhuQXBpS2V5KS50b0JlKCd2YWxpZC1iZWFyZXItdG9rZW4nKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudXNlcj8ubjhuQmFzZVVybCkudG9CZSgnaHR0cHM6Ly9kZWZhdWx0Lm44bi5pbycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY2FjaGUgbWFuYWdlbWVudCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNsZWFyIGNhY2hlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTjhuQXV0aFByb3ZpZGVyKCk7XG4gICAgICBwcm92aWRlci5jbGVhckNhY2hlKCk7XG5cbiAgICAgIGNvbnN0IHN0YXRzID0gcHJvdmlkZXIuZ2V0Q2FjaGVTdGF0cygpO1xuICAgICAgZXhwZWN0KHN0YXRzLnNpemUpLnRvQmUoMCk7XG4gICAgICBleHBlY3Qoc3RhdHMuZW50cmllcykudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcHJvdmlkZSBjYWNoZSBzdGF0aXN0aWNzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTjhuQXV0aFByb3ZpZGVyKCk7XG4gICAgICBjb25zdCBzdGF0cyA9IHByb3ZpZGVyLmdldENhY2hlU3RhdHMoKTtcblxuICAgICAgZXhwZWN0KHR5cGVvZiBzdGF0cy5zaXplKS50b0JlKCdudW1iZXInKTtcbiAgICAgIGV4cGVjdCh0eXBlb2Ygc3RhdHMuZW50cmllcykudG9CZSgnbnVtYmVyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsZWFuIHVwIGV4cGlyZWQgY2FjaGUgZW50cmllcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IE44bkF1dGhQcm92aWRlcih7IGNhY2hlRHVyYXRpb246IC0xIH0pOyAvLyBFeHBpcmVkIGltbWVkaWF0ZWx5XG4gICAgICBcbiAgICAgIC8vIE1hbnVhbGx5IGFkZCBleHBpcmVkIGNhY2hlIGVudHJ5IHRvIHRlc3QgY2xlYW51cFxuICAgICAgY29uc3QgY2FjaGUgPSAocHJvdmlkZXIgYXMgYW55KS5hdXRoQ2FjaGU7XG4gICAgICBjYWNoZS5zZXQoJ3Rlc3Qta2V5Jywge1xuICAgICAgICByZXN1bHQ6IHsgc3VjY2VzczogdHJ1ZSwgdXNlcjogeyBpZDogJ3Rlc3QnIH0gfSxcbiAgICAgICAgZXhwaXJlczogRGF0ZS5ub3coKSAtIDEwMDAgLy8gRXhwaXJlZCAxIHNlY29uZCBhZ29cbiAgICAgIH0pO1xuXG4gICAgICAvLyBUaGlzIHNob3VsZCB0cmlnZ2VyIGNsZWFudXAgb2YgZXhwaXJlZCBlbnRyaWVzXG4gICAgICBjb25zdCBzdGF0cyA9IHByb3ZpZGVyLmdldENhY2hlU3RhdHMoKTtcbiAgICAgIGV4cGVjdChzdGF0cy5lbnRyaWVzKS50b0JlKDApOyAvLyBFeHBpcmVkIGVudHJ5IHNob3VsZCBiZSBjbGVhbmVkIHVwXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBjYWNoZSB3aXRoIHplcm8gZHVyYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoeyBcbiAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIHZhbGlkYXRlQ29ubmVjdGlvbjogZmFsc2UsXG4gICAgICAgIGNhY2hlRHVyYXRpb246IDAsIC8vIE5vIGNhY2hpbmdcbiAgICAgICAgZGVmYXVsdEJhc2VVcmw6ICdodHRwczovL3Rlc3QubjhuLmlvJyxcbiAgICAgICAgZGVmYXVsdFJvbGVzOiBbJ21lbWJlciddLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGNvbnRleHQ6IFJlcXVlc3RDb250ZXh0ID0ge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ3gtbjhuLWFwaS1rZXknOiAndmFsaWQtYXBpLWtleScsXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm92aWRlci5hdXRoZW50aWNhdGUoY29udGV4dCk7XG4gICAgICBleHBlY3QocmVzdWx0LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFdpdGggemVybyBjYWNoZSBkdXJhdGlvbiwgbm90aGluZyBzaG91bGQgYmUgY2FjaGVkXG4gICAgICBjb25zdCBzdGF0cyA9IHByb3ZpZGVyLmdldENhY2hlU3RhdHMoKTtcbiAgICAgIGV4cGVjdChzdGF0cy5lbnRyaWVzKS50b0JlKDApOyBcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlZnJlc2ggYXV0aGVudGljYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZWZyZXNoIGF1dGhlbnRpY2F0aW9uIGJ5IGNsZWFyaW5nIGNhY2hlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgTjhuQXV0aFByb3ZpZGVyKHtcbiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICBjYWNoZUR1cmF0aW9uOiA2MDAwMCxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjb250ZXh0OiBSZXF1ZXN0Q29udGV4dCA9IHtcbiAgICAgICAgY2xpZW50SWQ6ICd0ZXN0LWNsaWVudCcsXG4gICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgfTtcblxuICAgICAgLy8gRmlyc3QgYXV0aGVudGljYXRlXG4gICAgICBjb25zdCByZXN1bHQxID0gYXdhaXQgcHJvdmlkZXIuYXV0aGVudGljYXRlKGNvbnRleHQpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuc3VjY2VzcykudG9CZSh0cnVlKTtcblxuICAgICAgLy8gUmVmcmVzaCBzaG91bGQgd29ya1xuICAgICAgY29uc3QgcmVzdWx0MiA9IGF3YWl0IHByb3ZpZGVyLnJlZnJlc2goY29udGV4dCk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdDIudXNlcj8uaWQpLnRvQmUoJ2Fub255bW91cycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWZyZXNoIGF1dGhlbnRpY2F0aW9uIHdpdGggdXNlciBjb250ZXh0IGFuZCBjbGVhciBzcGVjaWZpYyBjYWNoZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHByb3ZpZGVyID0gbmV3IE44bkF1dGhQcm92aWRlcih7XG4gICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICB2YWxpZGF0ZUNvbm5lY3Rpb246IGZhbHNlLFxuICAgICAgICBjYWNoZUR1cmF0aW9uOiA2MDAwMCxcbiAgICAgICAgZGVmYXVsdEJhc2VVcmw6ICdodHRwczovL3Rlc3QubjhuLmlvJyxcbiAgICAgICAgZGVmYXVsdEFwaUtleTogJ3Rlc3Qta2V5JyxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1c2VyID0ge1xuICAgICAgICBpZDogJ3Rlc3QtdXNlcicsXG4gICAgICAgIG5hbWU6ICdUZXN0IFVzZXInLFxuICAgICAgICByb2xlczogWydtZW1iZXInXSxcbiAgICAgICAgcGVybWlzc2lvbnM6IHtcbiAgICAgICAgICBjb21tdW5pdHk6IHRydWUsXG4gICAgICAgICAgZW50ZXJwcmlzZTogZmFsc2UsXG4gICAgICAgICAgd29ya2Zsb3dzOiB0cnVlLFxuICAgICAgICAgIGV4ZWN1dGlvbnM6IHRydWUsXG4gICAgICAgICAgY3JlZGVudGlhbHM6IGZhbHNlLFxuICAgICAgICAgIHVzZXJzOiBmYWxzZSxcbiAgICAgICAgICBhdWRpdDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIG44bkJhc2VVcmw6ICdodHRwczovL3Rlc3QubjhuLmlvJyxcbiAgICAgICAgbjhuQXBpS2V5OiAndGVzdC1rZXknLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgY29udGV4dDogUmVxdWVzdENvbnRleHQgPSB7XG4gICAgICAgIHVzZXIsXG4gICAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgfTtcblxuICAgICAgLy8gUmVmcmVzaCB3aXRoIHVzZXIgY29udGV4dCBzaG91bGQgY2xlYXIgY2FjaGUgZm9yIHRoYXQgdXNlclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvdmlkZXIucmVmcmVzaChjb250ZXh0KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VjY2VzcykudG9CZShmYWxzZSk7IC8vIE5vIGNyZWRlbnRpYWxzIGluIGhlYWRlcnMsIHNob3VsZCBmYWlsXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0NvbnRhaW4oJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkIGJ1dCBubyBjcmVkZW50aWFscyBwcm92aWRlZCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZXJyb3IgaGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgYXV0aGVudGljYXRpb24gZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoeyByZXF1aXJlZDogdHJ1ZSB9KTtcbiAgICAgIFxuICAgICAgLy8gTW9jayB0aGUgZXh0cmFjdENyZWRlbnRpYWxzIG1ldGhvZCB0byB0aHJvdyBhbiBlcnJvclxuICAgICAgamVzdC5zcHlPbihwcm92aWRlciBhcyBhbnksICdleHRyYWN0Q3JlZGVudGlhbHMnKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NyZWRlbnRpYWwgZXh0cmFjdGlvbiBmYWlsZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjb250ZXh0OiBSZXF1ZXN0Q29udGV4dCA9IHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICd4LW44bi1hcGkta2V5JzogJ3Rlc3Qta2V5JyxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb3ZpZGVyLmF1dGhlbnRpY2F0ZShjb250ZXh0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQ29udGFpbignQXV0aGVudGljYXRpb24gZmFpbGVkOiBDcmVkZW50aWFsIGV4dHJhY3Rpb24gZmFpbGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBub24tRXJyb3Igb2JqZWN0cyBpbiBjYXRjaCBibG9ja3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBOOG5BdXRoUHJvdmlkZXIoeyByZXF1aXJlZDogdHJ1ZSB9KTtcbiAgICAgIFxuICAgICAgLy8gTW9jayB0byB0aHJvdyBhIG5vbi1FcnJvciBvYmplY3RcbiAgICAgIGplc3Quc3B5T24ocHJvdmlkZXIgYXMgYW55LCAnZXh0cmFjdENyZWRlbnRpYWxzJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHtcbiAgICAgICAgdGhyb3cgJ1N0cmluZyBlcnJvcic7IC8vIE5vbi1FcnJvciBvYmplY3RcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBjb250ZXh0OiBSZXF1ZXN0Q29udGV4dCA9IHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICd4LW44bi1hcGkta2V5JzogJ3Rlc3Qta2V5JyxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByb3ZpZGVyLmF1dGhlbnRpY2F0ZShjb250ZXh0KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQ29udGFpbignQXV0aGVudGljYXRpb24gZmFpbGVkOiBTdHJpbmcgZXJyb3InKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ2NyZWF0ZU44bkF1dGgnLCAoKSA9PiB7XG4gIGxldCBvcmlnaW5hbEVudjogdHlwZW9mIHByb2Nlc3MuZW52O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG9yaWdpbmFsRW52ID0geyAuLi5wcm9jZXNzLmVudiB9O1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIHByb2Nlc3MuZW52ID0gb3JpZ2luYWxFbnY7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgY3JlYXRlIE44bkF1dGhQcm92aWRlciBpbnN0YW5jZScsICgpID0+IHtcbiAgICBjb25zdCBwcm92aWRlciA9IGNyZWF0ZU44bkF1dGgoKTtcbiAgICBleHBlY3QocHJvdmlkZXIpLnRvQmVJbnN0YW5jZU9mKE44bkF1dGhQcm92aWRlcik7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgaGFuZGxlIGVudmlyb25tZW50IHZhcmlhYmxlcycsICgpID0+IHtcbiAgICBwcm9jZXNzLmVudi5OOE5fTUNQX0FVVEhfUkVRVUlSRUQgPSAndHJ1ZSc7XG4gICAgcHJvY2Vzcy5lbnYuTjhOX0JBU0VfVVJMID0gJ2h0dHBzOi8vZW52Lm44bi5pbyc7XG4gICAgcHJvY2Vzcy5lbnYuTjhOX0FQSV9LRVkgPSAnZW52LWFwaS1rZXknO1xuXG4gICAgY29uc3QgcHJvdmlkZXIgPSBjcmVhdGVOOG5BdXRoKCk7XG4gICAgZXhwZWN0KHByb3ZpZGVyKS50b0JlSW5zdGFuY2VPZihOOG5BdXRoUHJvdmlkZXIpO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnZGVmYXVsdE44bkF1dGgnLCAoKSA9PiB7XG4gIGl0KCdzaG91bGQgYmUgYW4gaW5zdGFuY2Ugb2YgTjhuQXV0aFByb3ZpZGVyJywgKCkgPT4ge1xuICAgIGV4cGVjdChkZWZhdWx0TjhuQXV0aCkudG9CZUluc3RhbmNlT2YoTjhuQXV0aFByb3ZpZGVyKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBiZSBhIHNpbmdsZXRvbiBpbnN0YW5jZScsIGFzeW5jICgpID0+IHtcbiAgICAvLyBJbXBvcnQgYWdhaW4gdG8gdGVzdCBzaW5nbGV0b24gYmVoYXZpb3JcbiAgICBjb25zdCBtb2R1bGUgPSBhd2FpdCBpbXBvcnQoJy4uLy4uLy4uL3NyYy9hdXRoL244bkF1dGgnKTtcbiAgICBjb25zdCBzZWNvbmRJbnN0YW5jZSA9IG1vZHVsZS5kZWZhdWx0TjhuQXV0aDtcbiAgICBleHBlY3QoZGVmYXVsdE44bkF1dGgpLnRvQmUoc2Vjb25kSW5zdGFuY2UpO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9