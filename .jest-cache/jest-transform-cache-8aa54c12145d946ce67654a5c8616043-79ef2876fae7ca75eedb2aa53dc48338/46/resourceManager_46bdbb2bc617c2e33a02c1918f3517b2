bb50fdfa894643cccb1d4d57827cd99d
"use strict";
/**
 * Resource Manager for n8n MCP Server
 *
 * Central coordinator for all MCP resources, managing registration,
 * configuration, and lifecycle of resource providers.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.RESOURCE_ENV_CONFIG = exports.ResourceManager = void 0;
exports.createResourceManager = createResourceManager;
exports.parseResourceConfigFromEnv = parseResourceConfigFromEnv;
const workflowResources_js_1 = require("./workflowResources.js");
const executionResources_js_1 = require("./executionResources.js");
/**
 * Central resource manager
 *
 * Coordinates all resource providers and handles global resource configuration.
 */
class ResourceManager {
    config;
    workflowResources;
    executionResources;
    constructor(config = {}) {
        this.config = {
            baseUri: 'n8n://',
            enableWorkflows: true,
            enableExecutions: true,
            enableCredentials: false, // Disabled by default for security
            enableNodes: true,
            globalCacheDuration: 5 * 60 * 1000, // 5 minutes
            maxItems: 100,
            ...config,
        };
    }
    /**
     * Register all enabled resources with FastMCP server
     */
    register(server, getClient) {
        console.log('ðŸ“š Registering n8n MCP resources...');
        // Register workflow resources
        if (this.config.enableWorkflows) {
            this.workflowResources = (0, workflowResources_js_1.createWorkflowResources)({
                baseUri: `${this.config.baseUri}workflows`,
                maxWorkflows: this.config.maxItems,
                cacheDuration: this.config.globalCacheDuration,
            });
            this.workflowResources.register(server, getClient);
        }
        // Register execution resources
        if (this.config.enableExecutions) {
            this.executionResources = (0, executionResources_js_1.createExecutionResources)({
                baseUri: `${this.config.baseUri}executions`,
                maxExecutions: this.config.maxItems,
                cacheDuration: this.config.globalCacheDuration,
            });
            this.executionResources.register(server, getClient);
        }
        // Register node documentation resources
        if (this.config.enableNodes) {
            this.registerNodeResources(server, getClient);
        }
        // Register credential template resources (if enabled)
        if (this.config.enableCredentials) {
            this.registerCredentialResources(server, getClient);
        }
        // Register general n8n information resources
        this.registerGeneralResources(server, getClient);
        console.log('âœ… All n8n MCP resources registered');
    }
    /**
     * Register node documentation resources
     */
    registerNodeResources(server, getClient) {
        // Available nodes resource
        server.addResource({
            uri: `${this.config.baseUri}nodes/available`,
            name: 'n8n Available Nodes',
            mimeType: 'application/json',
            load: async () => {
                const nodes = await this.getAvailableNodes();
                return {
                    text: JSON.stringify(nodes, null, 2),
                };
            },
        });
        // Node documentation template
        server.addResourceTemplate({
            uriTemplate: `${this.config.baseUri}nodes/{nodeType}`,
            name: 'n8n Node Documentation',
            mimeType: 'application/json',
            arguments: [
                {
                    name: 'nodeType',
                    description: 'The type of n8n node (e.g., "n8n-nodes-base.httpRequest")',
                    required: true,
                },
            ],
            load: async ({ nodeType }) => {
                const nodeDoc = await this.getNodeDocumentation(nodeType);
                return {
                    text: JSON.stringify(nodeDoc, null, 2),
                };
            },
        });
        console.log('ðŸ“¦ Node resources registered');
    }
    /**
     * Register credential template resources
     */
    registerCredentialResources(server, getClient) {
        // Credential types resource
        server.addResource({
            uri: `${this.config.baseUri}credentials/types`,
            name: 'n8n Credential Types',
            mimeType: 'application/json',
            load: async () => {
                const credTypes = await this.getCredentialTypes();
                return {
                    text: JSON.stringify(credTypes, null, 2),
                };
            },
        });
        // Credential template
        server.addResourceTemplate({
            uriTemplate: `${this.config.baseUri}credentials/template/{credType}`,
            name: 'n8n Credential Template',
            mimeType: 'application/json',
            arguments: [
                {
                    name: 'credType',
                    description: 'The credential type name',
                    required: true,
                },
            ],
            load: async ({ credType }) => {
                const template = await this.getCredentialTemplate(credType);
                return {
                    text: JSON.stringify(template, null, 2),
                };
            },
        });
        console.log('ðŸ” Credential resources registered');
    }
    /**
     * Register general n8n information resources
     */
    registerGeneralResources(server, getClient) {
        // n8n instance information
        server.addResource({
            uri: `${this.config.baseUri}info`,
            name: 'n8n Instance Information',
            mimeType: 'application/json',
            load: async () => {
                const client = getClient();
                if (!client) {
                    throw new Error('n8n client not initialized. Run init-n8n first.');
                }
                const info = await this.getInstanceInfo(client);
                return {
                    text: JSON.stringify(info, null, 2),
                };
            },
        });
        // Resource directory/index
        server.addResource({
            uri: `${this.config.baseUri}index`,
            name: 'n8n Resource Directory',
            mimeType: 'application/json',
            load: async () => {
                const directory = this.getResourceDirectory();
                return {
                    text: JSON.stringify(directory, null, 2),
                };
            },
        });
        console.log('â„¹ï¸  General resources registered');
    }
    /**
     * Get available n8n nodes (mock data - would need to be retrieved from n8n API)
     */
    async getAvailableNodes() {
        // This would typically fetch from n8n API or node registry
        return {
            nodes: [
                {
                    name: 'HTTP Request',
                    type: 'n8n-nodes-base.httpRequest',
                    description: 'Makes HTTP requests and returns the response data',
                    category: 'Core Nodes',
                    version: 1,
                },
                {
                    name: 'Code',
                    type: 'n8n-nodes-base.code',
                    description: 'Run custom JavaScript code',
                    category: 'Core Nodes',
                    version: 1,
                },
                {
                    name: 'If',
                    type: 'n8n-nodes-base.if',
                    description: 'Conditional routing based on comparison operations',
                    category: 'Core Nodes',
                    version: 1,
                },
                // More nodes would be listed here
            ],
            metadata: {
                totalNodes: 500, // Example count
                categories: ['Core Nodes', 'Trigger Nodes', 'Regular Nodes'],
                lastUpdated: new Date().toISOString(),
            },
            resourceInfo: {
                uri: `${this.config.baseUri}nodes/available`,
                type: 'n8n-available-nodes',
                version: '1.0',
                lastAccessed: new Date().toISOString(),
            },
        };
    }
    /**
     * Get node documentation
     */
    async getNodeDocumentation(nodeType) {
        // This would fetch actual node documentation from n8n
        return {
            nodeType,
            name: nodeType.split('.').pop(),
            description: `Documentation for ${nodeType}`,
            parameters: [],
            examples: [],
            resourceInfo: {
                uri: `${this.config.baseUri}nodes/${nodeType}`,
                type: 'n8n-node-documentation',
                version: '1.0',
                lastAccessed: new Date().toISOString(),
            },
        };
    }
    /**
     * Get credential types
     */
    async getCredentialTypes() {
        return {
            credentialTypes: [
                {
                    name: 'httpBasicAuth',
                    displayName: 'Basic Auth',
                    properties: ['user', 'password'],
                },
                {
                    name: 'httpHeaderAuth',
                    displayName: 'Header Auth',
                    properties: ['name', 'value'],
                },
                // More credential types
            ],
            metadata: {
                totalTypes: 50, // Example count
                lastUpdated: new Date().toISOString(),
            },
            resourceInfo: {
                uri: `${this.config.baseUri}credentials/types`,
                type: 'n8n-credential-types',
                version: '1.0',
                lastAccessed: new Date().toISOString(),
            },
        };
    }
    /**
     * Get credential template (without sensitive data)
     */
    async getCredentialTemplate(credType) {
        return {
            credentialType: credType,
            template: {
                name: `${credType} Template`,
                type: credType,
                data: {
                    // Template structure without actual values
                    fields: ['user', 'password'], // Example fields
                },
            },
            resourceInfo: {
                uri: `${this.config.baseUri}credentials/template/${credType}`,
                type: 'n8n-credential-template',
                version: '1.0',
                lastAccessed: new Date().toISOString(),
            },
        };
    }
    /**
     * Get n8n instance information
     */
    async getInstanceInfo(client) {
        try {
            // Attempt to gather instance information
            const workflows = await client.getWorkflows({ limit: 1 });
            const executions = await client.getExecutions({ limit: 1 });
            return {
                status: 'connected',
                features: {
                    workflows: true,
                    executions: true,
                    // Test for Enterprise features
                    projects: await this.testFeature(() => client.getProjects({ limit: 1 })),
                    users: await this.testFeature(() => client.getUsers({ limit: 1 })),
                    variables: await this.testFeature(() => client.getVariables({ limit: 1 })),
                },
                statistics: {
                    totalWorkflows: workflows.data.length,
                    totalExecutions: executions.data.length,
                },
                resourceInfo: {
                    uri: `${this.config.baseUri}info`,
                    type: 'n8n-instance-info',
                    version: '1.0',
                    lastAccessed: new Date().toISOString(),
                },
            };
        }
        catch (error) {
            return {
                status: 'error',
                error: error instanceof Error ? error.message : String(error),
                resourceInfo: {
                    uri: `${this.config.baseUri}info`,
                    type: 'n8n-instance-info',
                    version: '1.0',
                    lastAccessed: new Date().toISOString(),
                },
            };
        }
    }
    /**
     * Test if a feature is available
     */
    async testFeature(testFn) {
        try {
            await testFn();
            return true;
        }
        catch {
            return false;
        }
    }
    /**
     * Get resource directory
     */
    getResourceDirectory() {
        const resources = [];
        if (this.config.enableWorkflows) {
            resources.push({
                name: 'Workflows',
                baseUri: `${this.config.baseUri}workflows`,
                description: 'Access n8n workflow definitions and metadata',
                endpoints: [
                    `${this.config.baseUri}workflows/list`,
                    `${this.config.baseUri}workflows/active`,
                    `${this.config.baseUri}workflows/stats`,
                    `${this.config.baseUri}workflows/{id}`,
                ],
            });
        }
        if (this.config.enableExecutions) {
            resources.push({
                name: 'Executions',
                baseUri: `${this.config.baseUri}executions`,
                description: 'Access n8n execution data, logs, and statistics',
                endpoints: [
                    `${this.config.baseUri}executions/recent`,
                    `${this.config.baseUri}executions/failures`,
                    `${this.config.baseUri}executions/stats`,
                    `${this.config.baseUri}executions/{id}`,
                    `${this.config.baseUri}executions/{id}/logs`,
                ],
            });
        }
        if (this.config.enableNodes) {
            resources.push({
                name: 'Nodes',
                baseUri: `${this.config.baseUri}nodes`,
                description: 'Access n8n node documentation and information',
                endpoints: [
                    `${this.config.baseUri}nodes/available`,
                    `${this.config.baseUri}nodes/{nodeType}`,
                ],
            });
        }
        return {
            resources,
            metadata: {
                totalResources: resources.length,
                baseUri: this.config.baseUri,
                version: '1.0',
            },
            resourceInfo: {
                uri: `${this.config.baseUri}index`,
                type: 'n8n-resource-directory',
                version: '1.0',
                lastAccessed: new Date().toISOString(),
            },
        };
    }
    /**
     * Clear all resource caches
     */
    clearAllCaches() {
        this.workflowResources?.clearCache();
        this.executionResources?.clearCache();
        console.log('ðŸ§¹ All resource caches cleared');
    }
    /**
     * Get cache statistics for all resources
     */
    getAllCacheStats() {
        return {
            workflows: this.workflowResources?.getCacheStats() || { size: 0, keys: [] },
            executions: this.executionResources?.getCacheStats() || { size: 0, keys: [] },
        };
    }
}
exports.ResourceManager = ResourceManager;
/**
 * Create resource manager
 */
function createResourceManager(config) {
    return new ResourceManager(config);
}
/**
 * Environment variable configuration for resources
 */
exports.RESOURCE_ENV_CONFIG = {
    /** Base URI for resources */
    BASE_URI: 'N8N_MCP_RESOURCE_BASE_URI',
    /** Enable/disable specific resource types */
    ENABLE_WORKFLOWS: 'N8N_MCP_ENABLE_WORKFLOW_RESOURCES',
    ENABLE_EXECUTIONS: 'N8N_MCP_ENABLE_EXECUTION_RESOURCES',
    ENABLE_CREDENTIALS: 'N8N_MCP_ENABLE_CREDENTIAL_RESOURCES',
    ENABLE_NODES: 'N8N_MCP_ENABLE_NODE_RESOURCES',
    /** Global configuration */
    CACHE_DURATION: 'N8N_MCP_RESOURCE_CACHE_DURATION',
    MAX_ITEMS: 'N8N_MCP_RESOURCE_MAX_ITEMS',
};
/**
 * Parse resource configuration from environment variables
 */
function parseResourceConfigFromEnv() {
    return {
        baseUri: process.env[exports.RESOURCE_ENV_CONFIG.BASE_URI] || undefined,
        enableWorkflows: process.env[exports.RESOURCE_ENV_CONFIG.ENABLE_WORKFLOWS] !== 'false',
        enableExecutions: process.env[exports.RESOURCE_ENV_CONFIG.ENABLE_EXECUTIONS] !== 'false',
        enableCredentials: process.env[exports.RESOURCE_ENV_CONFIG.ENABLE_CREDENTIALS] === 'true',
        enableNodes: process.env[exports.RESOURCE_ENV_CONFIG.ENABLE_NODES] !== 'false',
        globalCacheDuration: (() => {
            const value = process.env[exports.RESOURCE_ENV_CONFIG.CACHE_DURATION];
            return value ? parseInt(value) : undefined;
        })(),
        maxItems: (() => {
            const value = process.env[exports.RESOURCE_ENV_CONFIG.MAX_ITEMS];
            return value ? parseInt(value) : undefined;
        })(),
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2plcmVteXBhcmtlci9EZXNrdG9wL0NsYXVkZSBDb2RpbmcgUHJvamVjdHMvbjhuLW1jcC1zZXJ2ZXIvc3JjL3Jlc291cmNlcy9yZXNvdXJjZU1hbmFnZXIudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUErZEgsc0RBRUM7QUF1QkQsZ0VBZ0JDO0FBamdCRCxpRUFBMEY7QUFDMUYsbUVBQTZGO0FBNEI3Rjs7OztHQUlHO0FBQ0gsTUFBYSxlQUFlO0lBQ2xCLE1BQU0sQ0FBa0M7SUFDeEMsaUJBQWlCLENBQTJCO0lBQzVDLGtCQUFrQixDQUE0QjtJQUV0RCxZQUFZLFNBQWdDLEVBQUU7UUFDNUMsSUFBSSxDQUFDLE1BQU0sR0FBRztZQUNaLE9BQU8sRUFBRSxRQUFRO1lBQ2pCLGVBQWUsRUFBRSxJQUFJO1lBQ3JCLGdCQUFnQixFQUFFLElBQUk7WUFDdEIsaUJBQWlCLEVBQUUsS0FBSyxFQUFFLG1DQUFtQztZQUM3RCxXQUFXLEVBQUUsSUFBSTtZQUNqQixtQkFBbUIsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRSxZQUFZO1lBQ2hELFFBQVEsRUFBRSxHQUFHO1lBQ2IsR0FBRyxNQUFNO1NBQ1YsQ0FBQztJQUNKLENBQUM7SUFFRDs7T0FFRztJQUNJLFFBQVEsQ0FBQyxNQUFlLEVBQUUsU0FBaUM7UUFDaEUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO1FBRW5ELDhCQUE4QjtRQUM5QixJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDaEMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUEsOENBQXVCLEVBQUM7Z0JBQy9DLE9BQU8sRUFBRSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxXQUFXO2dCQUMxQyxZQUFZLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRO2dCQUNsQyxhQUFhLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUI7YUFDL0MsQ0FBQyxDQUFDO1lBQ0gs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MkJBQW1CLENBQUMsY0FBYyxDQUFDLENBQUM7WUFDOUQsT0FBTyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxFQUFFO1FBQ0osUUFBUSxFQUFFLENBQUMsR0FBRyxFQUFFO1lBQ2QsTUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBbUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6RCxPQUFPLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7UUFDN0MsQ0FBQyxDQUFDLEVBQUU7S0FDTCxDQUFDO0FBQ0osQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvamVyZW15cGFya2VyL0Rlc2t0b3AvQ2xhdWRlIENvZGluZyBQcm9qZWN0cy9uOG4tbWNwLXNlcnZlci9zcmMvcmVzb3VyY2VzL3Jlc291cmNlTWFuYWdlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJlc291cmNlIE1hbmFnZXIgZm9yIG44biBNQ1AgU2VydmVyXG4gKlxuICogQ2VudHJhbCBjb29yZGluYXRvciBmb3IgYWxsIE1DUCByZXNvdXJjZXMsIG1hbmFnaW5nIHJlZ2lzdHJhdGlvbixcbiAqIGNvbmZpZ3VyYXRpb24sIGFuZCBsaWZlY3ljbGUgb2YgcmVzb3VyY2UgcHJvdmlkZXJzLlxuICovXG5cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnVzZWQtdmFycyAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cblxuaW1wb3J0IHsgRmFzdE1DUCB9IGZyb20gJ2Zhc3RtY3AnO1xuaW1wb3J0IHsgTjhuQ2xpZW50IH0gZnJvbSAnLi4vY2xpZW50L244bkNsaWVudC5qcyc7XG5pbXBvcnQgeyBXb3JrZmxvd1Jlc291cmNlTWFuYWdlciwgY3JlYXRlV29ya2Zsb3dSZXNvdXJjZXMgfSBmcm9tICcuL3dvcmtmbG93UmVzb3VyY2VzLmpzJztcbmltcG9ydCB7IEV4ZWN1dGlvblJlc291cmNlTWFuYWdlciwgY3JlYXRlRXhlY3V0aW9uUmVzb3VyY2VzIH0gZnJvbSAnLi9leGVjdXRpb25SZXNvdXJjZXMuanMnO1xuXG4vKipcbiAqIFJlc291cmNlIG1hbmFnZXIgY29uZmlndXJhdGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIFJlc291cmNlTWFuYWdlckNvbmZpZyB7XG4gIC8qKiBCYXNlIFVSSSBwcmVmaXggZm9yIGFsbCBuOG4gcmVzb3VyY2VzICovXG4gIGJhc2VVcmk/OiBzdHJpbmc7XG5cbiAgLyoqIFdoZXRoZXIgdG8gZW5hYmxlIHdvcmtmbG93IHJlc291cmNlcyAqL1xuICBlbmFibGVXb3JrZmxvd3M/OiBib29sZWFuO1xuXG4gIC8qKiBXaGV0aGVyIHRvIGVuYWJsZSBleGVjdXRpb24gcmVzb3VyY2VzICovXG4gIGVuYWJsZUV4ZWN1dGlvbnM/OiBib29sZWFuO1xuXG4gIC8qKiBXaGV0aGVyIHRvIGVuYWJsZSBjcmVkZW50aWFsIHJlc291cmNlcyAqL1xuICBlbmFibGVDcmVkZW50aWFscz86IGJvb2xlYW47XG5cbiAgLyoqIFdoZXRoZXIgdG8gZW5hYmxlIG5vZGUgZG9jdW1lbnRhdGlvbiByZXNvdXJjZXMgKi9cbiAgZW5hYmxlTm9kZXM/OiBib29sZWFuO1xuXG4gIC8qKiBHbG9iYWwgY2FjaGUgZHVyYXRpb24gZm9yIGFsbCByZXNvdXJjZXMgKG1zKSAqL1xuICBnbG9iYWxDYWNoZUR1cmF0aW9uPzogbnVtYmVyO1xuXG4gIC8qKiBNYXhpbXVtIG51bWJlciBvZiBpdGVtcyBpbiByZXNvdXJjZSBsaXN0aW5ncyAqL1xuICBtYXhJdGVtcz86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBDZW50cmFsIHJlc291cmNlIG1hbmFnZXJcbiAqXG4gKiBDb29yZGluYXRlcyBhbGwgcmVzb3VyY2UgcHJvdmlkZXJzIGFuZCBoYW5kbGVzIGdsb2JhbCByZXNvdXJjZSBjb25maWd1cmF0aW9uLlxuICovXG5leHBvcnQgY2xhc3MgUmVzb3VyY2VNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBjb25maWc6IFJlcXVpcmVkPFJlc291cmNlTWFuYWdlckNvbmZpZz47XG4gIHByaXZhdGUgd29ya2Zsb3dSZXNvdXJjZXM/OiBXb3JrZmxvd1Jlc291cmNlTWFuYWdlcjtcbiAgcHJpdmF0ZSBleGVjdXRpb25SZXNvdXJjZXM/OiBFeGVjdXRpb25SZXNvdXJjZU1hbmFnZXI7XG5cbiAgY29uc3RydWN0b3IoY29uZmlnOiBSZXNvdXJjZU1hbmFnZXJDb25maWcgPSB7fSkge1xuICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgYmFzZVVyaTogJ244bjovLycsXG4gICAgICBlbmFibGVXb3JrZmxvd3M6IHRydWUsXG4gICAgICBlbmFibGVFeGVjdXRpb25zOiB0cnVlLFxuICAgICAgZW5hYmxlQ3JlZGVudGlhbHM6IGZhbHNlLCAvLyBEaXNhYmxlZCBieSBkZWZhdWx0IGZvciBzZWN1cml0eVxuICAgICAgZW5hYmxlTm9kZXM6IHRydWUsXG4gICAgICBnbG9iYWxDYWNoZUR1cmF0aW9uOiA1ICogNjAgKiAxMDAwLCAvLyA1IG1pbnV0ZXNcbiAgICAgIG1heEl0ZW1zOiAxMDAsXG4gICAgICAuLi5jb25maWcsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBhbGwgZW5hYmxlZCByZXNvdXJjZXMgd2l0aCBGYXN0TUNQIHNlcnZlclxuICAgKi9cbiAgcHVibGljIHJlZ2lzdGVyKHNlcnZlcjogRmFzdE1DUCwgZ2V0Q2xpZW50OiAoKSA9PiBOOG5DbGllbnQgfCBudWxsKTogdm9pZCB7XG4gICAgY29uc29sZS5sb2coJ/Cfk5ogUmVnaXN0ZXJpbmcgbjhuIE1DUCByZXNvdXJjZXMuLi4nKTtcblxuICAgIC8vIFJlZ2lzdGVyIHdvcmtmbG93IHJlc291cmNlc1xuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVXb3JrZmxvd3MpIHtcbiAgICAgIHRoaXMud29ya2Zsb3dSZXNvdXJjZXMgPSBjcmVhdGVXb3JrZmxvd1Jlc291cmNlcyh7XG4gICAgICAgIGJhc2VVcmk6IGAke3RoaXMuY29uZmlnLmJhc2VVcml9d29ya2Zsb3dzYCxcbiAgICAgICAgbWF4V29ya2Zsb3dzOiB0aGlzLmNvbmZpZy5tYXhJdGVtcyxcbiAgICAgICAgY2FjaGVEdXJhdGlvbjogdGhpcy5jb25maWcuZ2xvYmFsQ2FjaGVEdXJhdGlvbixcbiAgICAgIH0pO1xuICAgICAgdGhpcy53b3JrZmxvd1Jlc291cmNlcy5yZWdpc3RlcihzZXJ2ZXIsIGdldENsaWVudCk7XG4gICAgfVxuXG4gICAgLy8gUmVnaXN0ZXIgZXhlY3V0aW9uIHJlc291cmNlc1xuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVFeGVjdXRpb25zKSB7XG4gICAgICB0aGlzLmV4ZWN1dGlvblJlc291cmNlcyA9IGNyZWF0ZUV4ZWN1dGlvblJlc291cmNlcyh7XG4gICAgICAgIGJhc2VVcmk6IGAke3RoaXMuY29uZmlnLmJhc2VVcml9ZXhlY3V0aW9uc2AsXG4gICAgICAgIG1heEV4ZWN1dGlvbnM6IHRoaXMuY29uZmlnLm1heEl0ZW1zLFxuICAgICAgICBjYWNoZUR1cmF0aW9uOiB0aGlzLmNvbmZpZy5nbG9iYWxDYWNoZUR1cmF0aW9uLFxuICAgICAgfSk7XG4gICAgICB0aGlzLmV4ZWN1dGlvblJlc291cmNlcy5yZWdpc3RlcihzZXJ2ZXIsIGdldENsaWVudCk7XG4gICAgfVxuXG4gICAgLy8gUmVnaXN0ZXIgbm9kZSBkb2N1bWVudGF0aW9uIHJlc291cmNlc1xuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVOb2Rlcykge1xuICAgICAgdGhpcy5yZWdpc3Rlck5vZGVSZXNvdXJjZXMoc2VydmVyLCBnZXRDbGllbnQpO1xuICAgIH1cblxuICAgIC8vIFJlZ2lzdGVyIGNyZWRlbnRpYWwgdGVtcGxhdGUgcmVzb3VyY2VzIChpZiBlbmFibGVkKVxuICAgIGlmICh0aGlzLmNvbmZpZy5lbmFibGVDcmVkZW50aWFscykge1xuICAgICAgdGhpcy5yZWdpc3RlckNyZWRlbnRpYWxSZXNvdXJjZXMoc2VydmVyLCBnZXRDbGllbnQpO1xuICAgIH1cblxuICAgIC8vIFJlZ2lzdGVyIGdlbmVyYWwgbjhuIGluZm9ybWF0aW9uIHJlc291cmNlc1xuICAgIHRoaXMucmVnaXN0ZXJHZW5lcmFsUmVzb3VyY2VzKHNlcnZlciwgZ2V0Q2xpZW50KTtcblxuICAgIGNvbnNvbGUubG9nKCfinIUgQWxsIG44biBNQ1AgcmVzb3VyY2VzIHJlZ2lzdGVyZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBub2RlIGRvY3VtZW50YXRpb24gcmVzb3VyY2VzXG4gICAqL1xuICBwcml2YXRlIHJlZ2lzdGVyTm9kZVJlc291cmNlcyhzZXJ2ZXI6IEZhc3RNQ1AsIGdldENsaWVudDogKCkgPT4gTjhuQ2xpZW50IHwgbnVsbCk6IHZvaWQge1xuICAgIC8vIEF2YWlsYWJsZSBub2RlcyByZXNvdXJjZVxuICAgIHNlcnZlci5hZGRSZXNvdXJjZSh7XG4gICAgICB1cmk6IGAke3RoaXMuY29uZmlnLmJhc2VVcml9bm9kZXMvYXZhaWxhYmxlYCxcbiAgICAgIG5hbWU6ICduOG4gQXZhaWxhYmxlIE5vZGVzJyxcbiAgICAgIG1pbWVUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICBsb2FkOiBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVOb2RlcygpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KG5vZGVzLCBudWxsLCAyKSxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBOb2RlIGRvY3VtZW50YXRpb24gdGVtcGxhdGVcbiAgICBzZXJ2ZXIuYWRkUmVzb3VyY2VUZW1wbGF0ZSh7XG4gICAgICB1cmlUZW1wbGF0ZTogYCR7dGhpcy5jb25maWcuYmFzZVVyaX1ub2Rlcy97bm9kZVR5cGV9YCxcbiAgICAgIG5hbWU6ICduOG4gTm9kZSBEb2N1bWVudGF0aW9uJyxcbiAgICAgIG1pbWVUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICBhcmd1bWVudHM6IFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdub2RlVHlwZScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdUaGUgdHlwZSBvZiBuOG4gbm9kZSAoZS5nLiwgXCJuOG4tbm9kZXMtYmFzZS5odHRwUmVxdWVzdFwiKScsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgbG9hZDogYXN5bmMgKHsgbm9kZVR5cGUgfTogeyBub2RlVHlwZTogc3RyaW5nIH0pID0+IHtcbiAgICAgICAgY29uc3Qgbm9kZURvYyA9IGF3YWl0IHRoaXMuZ2V0Tm9kZURvY3VtZW50YXRpb24obm9kZVR5cGUpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHRleHQ6IEpTT04uc3RyaW5naWZ5KG5vZGVEb2MsIG51bGwsIDIpLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCfwn5OmIE5vZGUgcmVzb3VyY2VzIHJlZ2lzdGVyZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWdpc3RlciBjcmVkZW50aWFsIHRlbXBsYXRlIHJlc291cmNlc1xuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckNyZWRlbnRpYWxSZXNvdXJjZXMoc2VydmVyOiBGYXN0TUNQLCBnZXRDbGllbnQ6ICgpID0+IE44bkNsaWVudCB8IG51bGwpOiB2b2lkIHtcbiAgICAvLyBDcmVkZW50aWFsIHR5cGVzIHJlc291cmNlXG4gICAgc2VydmVyLmFkZFJlc291cmNlKHtcbiAgICAgIHVyaTogYCR7dGhpcy5jb25maWcuYmFzZVVyaX1jcmVkZW50aWFscy90eXBlc2AsXG4gICAgICBuYW1lOiAnbjhuIENyZWRlbnRpYWwgVHlwZXMnLFxuICAgICAgbWltZVR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIGxvYWQ6IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgY3JlZFR5cGVzID0gYXdhaXQgdGhpcy5nZXRDcmVkZW50aWFsVHlwZXMoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeShjcmVkVHlwZXMsIG51bGwsIDIpLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIC8vIENyZWRlbnRpYWwgdGVtcGxhdGVcbiAgICBzZXJ2ZXIuYWRkUmVzb3VyY2VUZW1wbGF0ZSh7XG4gICAgICB1cmlUZW1wbGF0ZTogYCR7dGhpcy5jb25maWcuYmFzZVVyaX1jcmVkZW50aWFscy90ZW1wbGF0ZS97Y3JlZFR5cGV9YCxcbiAgICAgIG5hbWU6ICduOG4gQ3JlZGVudGlhbCBUZW1wbGF0ZScsXG4gICAgICBtaW1lVHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgYXJndW1lbnRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnY3JlZFR5cGUnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnVGhlIGNyZWRlbnRpYWwgdHlwZSBuYW1lJyxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICBsb2FkOiBhc3luYyAoeyBjcmVkVHlwZSB9OiB7IGNyZWRUeXBlOiBzdHJpbmcgfSkgPT4ge1xuICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IGF3YWl0IHRoaXMuZ2V0Q3JlZGVudGlhbFRlbXBsYXRlKGNyZWRUeXBlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeSh0ZW1wbGF0ZSwgbnVsbCwgMiksXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29uc29sZS5sb2coJ/CflJAgQ3JlZGVudGlhbCByZXNvdXJjZXMgcmVnaXN0ZXJlZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGdlbmVyYWwgbjhuIGluZm9ybWF0aW9uIHJlc291cmNlc1xuICAgKi9cbiAgcHJpdmF0ZSByZWdpc3RlckdlbmVyYWxSZXNvdXJjZXMoc2VydmVyOiBGYXN0TUNQLCBnZXRDbGllbnQ6ICgpID0+IE44bkNsaWVudCB8IG51bGwpOiB2b2lkIHtcbiAgICAvLyBuOG4gaW5zdGFuY2UgaW5mb3JtYXRpb25cbiAgICBzZXJ2ZXIuYWRkUmVzb3VyY2Uoe1xuICAgICAgdXJpOiBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfWluZm9gLFxuICAgICAgbmFtZTogJ244biBJbnN0YW5jZSBJbmZvcm1hdGlvbicsXG4gICAgICBtaW1lVHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgbG9hZDogYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBjbGllbnQgPSBnZXRDbGllbnQoKTtcbiAgICAgICAgaWYgKCFjbGllbnQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ244biBjbGllbnQgbm90IGluaXRpYWxpemVkLiBSdW4gaW5pdC1uOG4gZmlyc3QuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpbmZvID0gYXdhaXQgdGhpcy5nZXRJbnN0YW5jZUluZm8oY2xpZW50KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeShpbmZvLCBudWxsLCAyKSxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBSZXNvdXJjZSBkaXJlY3RvcnkvaW5kZXhcbiAgICBzZXJ2ZXIuYWRkUmVzb3VyY2Uoe1xuICAgICAgdXJpOiBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfWluZGV4YCxcbiAgICAgIG5hbWU6ICduOG4gUmVzb3VyY2UgRGlyZWN0b3J5JyxcbiAgICAgIG1pbWVUeXBlOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICBsb2FkOiBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGRpcmVjdG9yeSA9IHRoaXMuZ2V0UmVzb3VyY2VEaXJlY3RvcnkoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0ZXh0OiBKU09OLnN0cmluZ2lmeShkaXJlY3RvcnksIG51bGwsIDIpLFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCfihLnvuI8gIEdlbmVyYWwgcmVzb3VyY2VzIHJlZ2lzdGVyZWQnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYXZhaWxhYmxlIG44biBub2RlcyAobW9jayBkYXRhIC0gd291bGQgbmVlZCB0byBiZSByZXRyaWV2ZWQgZnJvbSBuOG4gQVBJKVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyBnZXRBdmFpbGFibGVOb2RlcygpOiBQcm9taXNlPGFueT4ge1xuICAgIC8vIFRoaXMgd291bGQgdHlwaWNhbGx5IGZldGNoIGZyb20gbjhuIEFQSSBvciBub2RlIHJlZ2lzdHJ5XG4gICAgcmV0dXJuIHtcbiAgICAgIG5vZGVzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnSFRUUCBSZXF1ZXN0JyxcbiAgICAgICAgICB0eXBlOiAnbjhuLW5vZGVzLWJhc2UuaHR0cFJlcXVlc3QnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTWFrZXMgSFRUUCByZXF1ZXN0cyBhbmQgcmV0dXJucyB0aGUgcmVzcG9uc2UgZGF0YScsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdDb3JlIE5vZGVzJyxcbiAgICAgICAgICB2ZXJzaW9uOiAxLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ0NvZGUnLFxuICAgICAgICAgIHR5cGU6ICduOG4tbm9kZXMtYmFzZS5jb2RlJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ1J1biBjdXN0b20gSmF2YVNjcmlwdCBjb2RlJyxcbiAgICAgICAgICBjYXRlZ29yeTogJ0NvcmUgTm9kZXMnLFxuICAgICAgICAgIHZlcnNpb246IDEsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnSWYnLFxuICAgICAgICAgIHR5cGU6ICduOG4tbm9kZXMtYmFzZS5pZicsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdDb25kaXRpb25hbCByb3V0aW5nIGJhc2VkIG9uIGNvbXBhcmlzb24gb3BlcmF0aW9ucycsXG4gICAgICAgICAgY2F0ZWdvcnk6ICdDb3JlIE5vZGVzJyxcbiAgICAgICAgICB2ZXJzaW9uOiAxLFxuICAgICAgICB9LFxuICAgICAgICAvLyBNb3JlIG5vZGVzIHdvdWxkIGJlIGxpc3RlZCBoZXJlXG4gICAgICBdLFxuICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgdG90YWxOb2RlczogNTAwLCAvLyBFeGFtcGxlIGNvdW50XG4gICAgICAgIGNhdGVnb3JpZXM6IFsnQ29yZSBOb2RlcycsICdUcmlnZ2VyIE5vZGVzJywgJ1JlZ3VsYXIgTm9kZXMnXSxcbiAgICAgICAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIH0sXG4gICAgICByZXNvdXJjZUluZm86IHtcbiAgICAgICAgdXJpOiBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfW5vZGVzL2F2YWlsYWJsZWAsXG4gICAgICAgIHR5cGU6ICduOG4tYXZhaWxhYmxlLW5vZGVzJyxcbiAgICAgICAgdmVyc2lvbjogJzEuMCcsXG4gICAgICAgIGxhc3RBY2Nlc3NlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBub2RlIGRvY3VtZW50YXRpb25cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0Tm9kZURvY3VtZW50YXRpb24obm9kZVR5cGU6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgLy8gVGhpcyB3b3VsZCBmZXRjaCBhY3R1YWwgbm9kZSBkb2N1bWVudGF0aW9uIGZyb20gbjhuXG4gICAgcmV0dXJuIHtcbiAgICAgIG5vZGVUeXBlLFxuICAgICAgbmFtZTogbm9kZVR5cGUuc3BsaXQoJy4nKS5wb3AoKSxcbiAgICAgIGRlc2NyaXB0aW9uOiBgRG9jdW1lbnRhdGlvbiBmb3IgJHtub2RlVHlwZX1gLFxuICAgICAgcGFyYW1ldGVyczogW10sXG4gICAgICBleGFtcGxlczogW10sXG4gICAgICByZXNvdXJjZUluZm86IHtcbiAgICAgICAgdXJpOiBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfW5vZGVzLyR7bm9kZVR5cGV9YCxcbiAgICAgICAgdHlwZTogJ244bi1ub2RlLWRvY3VtZW50YXRpb24nLFxuICAgICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgICAgbGFzdEFjY2Vzc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNyZWRlbnRpYWwgdHlwZXNcbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0Q3JlZGVudGlhbFR5cGVzKCk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNyZWRlbnRpYWxUeXBlczogW1xuICAgICAgICB7XG4gICAgICAgICAgbmFtZTogJ2h0dHBCYXNpY0F1dGgnLFxuICAgICAgICAgIGRpc3BsYXlOYW1lOiAnQmFzaWMgQXV0aCcsXG4gICAgICAgICAgcHJvcGVydGllczogWyd1c2VyJywgJ3Bhc3N3b3JkJ10sXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBuYW1lOiAnaHR0cEhlYWRlckF1dGgnLFxuICAgICAgICAgIGRpc3BsYXlOYW1lOiAnSGVhZGVyIEF1dGgnLFxuICAgICAgICAgIHByb3BlcnRpZXM6IFsnbmFtZScsICd2YWx1ZSddLFxuICAgICAgICB9LFxuICAgICAgICAvLyBNb3JlIGNyZWRlbnRpYWwgdHlwZXNcbiAgICAgIF0sXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICB0b3RhbFR5cGVzOiA1MCwgLy8gRXhhbXBsZSBjb3VudFxuICAgICAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSxcbiAgICAgIHJlc291cmNlSW5mbzoge1xuICAgICAgICB1cmk6IGAke3RoaXMuY29uZmlnLmJhc2VVcml9Y3JlZGVudGlhbHMvdHlwZXNgLFxuICAgICAgICB0eXBlOiAnbjhuLWNyZWRlbnRpYWwtdHlwZXMnLFxuICAgICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgICAgbGFzdEFjY2Vzc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogR2V0IGNyZWRlbnRpYWwgdGVtcGxhdGUgKHdpdGhvdXQgc2Vuc2l0aXZlIGRhdGEpXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIGdldENyZWRlbnRpYWxUZW1wbGF0ZShjcmVkVHlwZTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4ge1xuICAgICAgY3JlZGVudGlhbFR5cGU6IGNyZWRUeXBlLFxuICAgICAgdGVtcGxhdGU6IHtcbiAgICAgICAgbmFtZTogYCR7Y3JlZFR5cGV9IFRlbXBsYXRlYCxcbiAgICAgICAgdHlwZTogY3JlZFR5cGUsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAvLyBUZW1wbGF0ZSBzdHJ1Y3R1cmUgd2l0aG91dCBhY3R1YWwgdmFsdWVzXG4gICAgICAgICAgZmllbGRzOiBbJ3VzZXInLCAncGFzc3dvcmQnXSwgLy8gRXhhbXBsZSBmaWVsZHNcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICByZXNvdXJjZUluZm86IHtcbiAgICAgICAgdXJpOiBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfWNyZWRlbnRpYWxzL3RlbXBsYXRlLyR7Y3JlZFR5cGV9YCxcbiAgICAgICAgdHlwZTogJ244bi1jcmVkZW50aWFsLXRlbXBsYXRlJyxcbiAgICAgICAgdmVyc2lvbjogJzEuMCcsXG4gICAgICAgIGxhc3RBY2Nlc3NlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSxcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBuOG4gaW5zdGFuY2UgaW5mb3JtYXRpb25cbiAgICovXG4gIHByaXZhdGUgYXN5bmMgZ2V0SW5zdGFuY2VJbmZvKGNsaWVudDogTjhuQ2xpZW50KTogUHJvbWlzZTxhbnk+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQXR0ZW1wdCB0byBnYXRoZXIgaW5zdGFuY2UgaW5mb3JtYXRpb25cbiAgICAgIGNvbnN0IHdvcmtmbG93cyA9IGF3YWl0IGNsaWVudC5nZXRXb3JrZmxvd3MoeyBsaW1pdDogMSB9KTtcbiAgICAgIGNvbnN0IGV4ZWN1dGlvbnMgPSBhd2FpdCBjbGllbnQuZ2V0RXhlY3V0aW9ucyh7IGxpbWl0OiAxIH0pO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdGF0dXM6ICdjb25uZWN0ZWQnLFxuICAgICAgICBmZWF0dXJlczoge1xuICAgICAgICAgIHdvcmtmbG93czogdHJ1ZSxcbiAgICAgICAgICBleGVjdXRpb25zOiB0cnVlLFxuICAgICAgICAgIC8vIFRlc3QgZm9yIEVudGVycHJpc2UgZmVhdHVyZXNcbiAgICAgICAgICBwcm9qZWN0czogYXdhaXQgdGhpcy50ZXN0RmVhdHVyZSgoKSA9PiBjbGllbnQuZ2V0UHJvamVjdHMoeyBsaW1pdDogMSB9KSksXG4gICAgICAgICAgdXNlcnM6IGF3YWl0IHRoaXMudGVzdEZlYXR1cmUoKCkgPT4gY2xpZW50LmdldFVzZXJzKHsgbGltaXQ6IDEgfSkpLFxuICAgICAgICAgIHZhcmlhYmxlczogYXdhaXQgdGhpcy50ZXN0RmVhdHVyZSgoKSA9PiBjbGllbnQuZ2V0VmFyaWFibGVzKHsgbGltaXQ6IDEgfSkpLFxuICAgICAgICB9LFxuICAgICAgICBzdGF0aXN0aWNzOiB7XG4gICAgICAgICAgdG90YWxXb3JrZmxvd3M6IHdvcmtmbG93cy5kYXRhLmxlbmd0aCxcbiAgICAgICAgICB0b3RhbEV4ZWN1dGlvbnM6IGV4ZWN1dGlvbnMuZGF0YS5sZW5ndGgsXG4gICAgICAgIH0sXG4gICAgICAgIHJlc291cmNlSW5mbzoge1xuICAgICAgICAgIHVyaTogYCR7dGhpcy5jb25maWcuYmFzZVVyaX1pbmZvYCxcbiAgICAgICAgICB0eXBlOiAnbjhuLWluc3RhbmNlLWluZm8nLFxuICAgICAgICAgIHZlcnNpb246ICcxLjAnLFxuICAgICAgICAgIGxhc3RBY2Nlc3NlZDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdHVzOiAnZXJyb3InLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpLFxuICAgICAgICByZXNvdXJjZUluZm86IHtcbiAgICAgICAgICB1cmk6IGAke3RoaXMuY29uZmlnLmJhc2VVcml9aW5mb2AsXG4gICAgICAgICAgdHlwZTogJ244bi1pbnN0YW5jZS1pbmZvJyxcbiAgICAgICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgICAgICBsYXN0QWNjZXNzZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFRlc3QgaWYgYSBmZWF0dXJlIGlzIGF2YWlsYWJsZVxuICAgKi9cbiAgcHJpdmF0ZSBhc3luYyB0ZXN0RmVhdHVyZSh0ZXN0Rm46ICgpID0+IFByb21pc2U8YW55Pik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0ZXN0Rm4oKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgcmVzb3VyY2UgZGlyZWN0b3J5XG4gICAqL1xuICBwcml2YXRlIGdldFJlc291cmNlRGlyZWN0b3J5KCk6IGFueSB7XG4gICAgY29uc3QgcmVzb3VyY2VzOiBhbnlbXSA9IFtdO1xuXG4gICAgaWYgKHRoaXMuY29uZmlnLmVuYWJsZVdvcmtmbG93cykge1xuICAgICAgcmVzb3VyY2VzLnB1c2goe1xuICAgICAgICBuYW1lOiAnV29ya2Zsb3dzJyxcbiAgICAgICAgYmFzZVVyaTogYCR7dGhpcy5jb25maWcuYmFzZVVyaX13b3JrZmxvd3NgLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FjY2VzcyBuOG4gd29ya2Zsb3cgZGVmaW5pdGlvbnMgYW5kIG1ldGFkYXRhJyxcbiAgICAgICAgZW5kcG9pbnRzOiBbXG4gICAgICAgICAgYCR7dGhpcy5jb25maWcuYmFzZVVyaX13b3JrZmxvd3MvbGlzdGAsXG4gICAgICAgICAgYCR7dGhpcy5jb25maWcuYmFzZVVyaX13b3JrZmxvd3MvYWN0aXZlYCxcbiAgICAgICAgICBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfXdvcmtmbG93cy9zdGF0c2AsXG4gICAgICAgICAgYCR7dGhpcy5jb25maWcuYmFzZVVyaX13b3JrZmxvd3Mve2lkfWAsXG4gICAgICAgIF0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb25maWcuZW5hYmxlRXhlY3V0aW9ucykge1xuICAgICAgcmVzb3VyY2VzLnB1c2goe1xuICAgICAgICBuYW1lOiAnRXhlY3V0aW9ucycsXG4gICAgICAgIGJhc2VVcmk6IGAke3RoaXMuY29uZmlnLmJhc2VVcml9ZXhlY3V0aW9uc2AsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQWNjZXNzIG44biBleGVjdXRpb24gZGF0YSwgbG9ncywgYW5kIHN0YXRpc3RpY3MnLFxuICAgICAgICBlbmRwb2ludHM6IFtcbiAgICAgICAgICBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfWV4ZWN1dGlvbnMvcmVjZW50YCxcbiAgICAgICAgICBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfWV4ZWN1dGlvbnMvZmFpbHVyZXNgLFxuICAgICAgICAgIGAke3RoaXMuY29uZmlnLmJhc2VVcml9ZXhlY3V0aW9ucy9zdGF0c2AsXG4gICAgICAgICAgYCR7dGhpcy5jb25maWcuYmFzZVVyaX1leGVjdXRpb25zL3tpZH1gLFxuICAgICAgICAgIGAke3RoaXMuY29uZmlnLmJhc2VVcml9ZXhlY3V0aW9ucy97aWR9L2xvZ3NgLFxuICAgICAgICBdLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY29uZmlnLmVuYWJsZU5vZGVzKSB7XG4gICAgICByZXNvdXJjZXMucHVzaCh7XG4gICAgICAgIG5hbWU6ICdOb2RlcycsXG4gICAgICAgIGJhc2VVcmk6IGAke3RoaXMuY29uZmlnLmJhc2VVcml9bm9kZXNgLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FjY2VzcyBuOG4gbm9kZSBkb2N1bWVudGF0aW9uIGFuZCBpbmZvcm1hdGlvbicsXG4gICAgICAgIGVuZHBvaW50czogW1xuICAgICAgICAgIGAke3RoaXMuY29uZmlnLmJhc2VVcml9bm9kZXMvYXZhaWxhYmxlYCxcbiAgICAgICAgICBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfW5vZGVzL3tub2RlVHlwZX1gLFxuICAgICAgICBdLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc291cmNlcyxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHRvdGFsUmVzb3VyY2VzOiByZXNvdXJjZXMubGVuZ3RoLFxuICAgICAgICBiYXNlVXJpOiB0aGlzLmNvbmZpZy5iYXNlVXJpLFxuICAgICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgIH0sXG4gICAgICByZXNvdXJjZUluZm86IHtcbiAgICAgICAgdXJpOiBgJHt0aGlzLmNvbmZpZy5iYXNlVXJpfWluZGV4YCxcbiAgICAgICAgdHlwZTogJ244bi1yZXNvdXJjZS1kaXJlY3RvcnknLFxuICAgICAgICB2ZXJzaW9uOiAnMS4wJyxcbiAgICAgICAgbGFzdEFjY2Vzc2VkOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2xlYXIgYWxsIHJlc291cmNlIGNhY2hlc1xuICAgKi9cbiAgcHVibGljIGNsZWFyQWxsQ2FjaGVzKCk6IHZvaWQge1xuICAgIHRoaXMud29ya2Zsb3dSZXNvdXJjZXM/LmNsZWFyQ2FjaGUoKTtcbiAgICB0aGlzLmV4ZWN1dGlvblJlc291cmNlcz8uY2xlYXJDYWNoZSgpO1xuICAgIGNvbnNvbGUubG9nKCfwn6e5IEFsbCByZXNvdXJjZSBjYWNoZXMgY2xlYXJlZCcpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjYWNoZSBzdGF0aXN0aWNzIGZvciBhbGwgcmVzb3VyY2VzXG4gICAqL1xuICBwdWJsaWMgZ2V0QWxsQ2FjaGVTdGF0cygpOiBhbnkge1xuICAgIHJldHVybiB7XG4gICAgICB3b3JrZmxvd3M6IHRoaXMud29ya2Zsb3dSZXNvdXJjZXM/LmdldENhY2hlU3RhdHMoKSB8fCB7IHNpemU6IDAsIGtleXM6IFtdIH0sXG4gICAgICBleGVjdXRpb25zOiB0aGlzLmV4ZWN1dGlvblJlc291cmNlcz8uZ2V0Q2FjaGVTdGF0cygpIHx8IHsgc2l6ZTogMCwga2V5czogW10gfSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc291cmNlIG1hbmFnZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlc291cmNlTWFuYWdlcihjb25maWc/OiBSZXNvdXJjZU1hbmFnZXJDb25maWcpOiBSZXNvdXJjZU1hbmFnZXIge1xuICByZXR1cm4gbmV3IFJlc291cmNlTWFuYWdlcihjb25maWcpO1xufVxuXG4vKipcbiAqIEVudmlyb25tZW50IHZhcmlhYmxlIGNvbmZpZ3VyYXRpb24gZm9yIHJlc291cmNlc1xuICovXG5leHBvcnQgY29uc3QgUkVTT1VSQ0VfRU5WX0NPTkZJRyA9IHtcbiAgLyoqIEJhc2UgVVJJIGZvciByZXNvdXJjZXMgKi9cbiAgQkFTRV9VUkk6ICdOOE5fTUNQX1JFU09VUkNFX0JBU0VfVVJJJyxcblxuICAvKiogRW5hYmxlL2Rpc2FibGUgc3BlY2lmaWMgcmVzb3VyY2UgdHlwZXMgKi9cbiAgRU5BQkxFX1dPUktGTE9XUzogJ044Tl9NQ1BfRU5BQkxFX1dPUktGTE9XX1JFU09VUkNFUycsXG4gIEVOQUJMRV9FWEVDVVRJT05TOiAnTjhOX01DUF9FTkFCTEVfRVhFQ1VUSU9OX1JFU09VUkNFUycsXG4gIEVOQUJMRV9DUkVERU5USUFMUzogJ044Tl9NQ1BfRU5BQkxFX0NSRURFTlRJQUxfUkVTT1VSQ0VTJyxcbiAgRU5BQkxFX05PREVTOiAnTjhOX01DUF9FTkFCTEVfTk9ERV9SRVNPVVJDRVMnLFxuXG4gIC8qKiBHbG9iYWwgY29uZmlndXJhdGlvbiAqL1xuICBDQUNIRV9EVVJBVElPTjogJ044Tl9NQ1BfUkVTT1VSQ0VfQ0FDSEVfRFVSQVRJT04nLFxuICBNQVhfSVRFTVM6ICdOOE5fTUNQX1JFU09VUkNFX01BWF9JVEVNUycsXG59IGFzIGNvbnN0O1xuXG4vKipcbiAqIFBhcnNlIHJlc291cmNlIGNvbmZpZ3VyYXRpb24gZnJvbSBlbnZpcm9ubWVudCB2YXJpYWJsZXNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlUmVzb3VyY2VDb25maWdGcm9tRW52KCk6IFJlc291cmNlTWFuYWdlckNvbmZpZyB7XG4gIHJldHVybiB7XG4gICAgYmFzZVVyaTogcHJvY2Vzcy5lbnZbUkVTT1VSQ0VfRU5WX0NPTkZJRy5CQVNFX1VSSV0gfHwgdW5kZWZpbmVkLFxuICAgIGVuYWJsZVdvcmtmbG93czogcHJvY2Vzcy5lbnZbUkVTT1VSQ0VfRU5WX0NPTkZJRy5FTkFCTEVfV09SS0ZMT1dTXSAhPT0gJ2ZhbHNlJyxcbiAgICBlbmFibGVFeGVjdXRpb25zOiBwcm9jZXNzLmVudltSRVNPVVJDRV9FTlZfQ09ORklHLkVOQUJMRV9FWEVDVVRJT05TXSAhPT0gJ2ZhbHNlJyxcbiAgICBlbmFibGVDcmVkZW50aWFsczogcHJvY2Vzcy5lbnZbUkVTT1VSQ0VfRU5WX0NPTkZJRy5FTkFCTEVfQ1JFREVOVElBTFNdID09PSAndHJ1ZScsXG4gICAgZW5hYmxlTm9kZXM6IHByb2Nlc3MuZW52W1JFU09VUkNFX0VOVl9DT05GSUcuRU5BQkxFX05PREVTXSAhPT0gJ2ZhbHNlJyxcbiAgICBnbG9iYWxDYWNoZUR1cmF0aW9uOiAoKCkgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSBwcm9jZXNzLmVudltSRVNPVVJDRV9FTlZfQ09ORklHLkNBQ0hFX0RVUkFUSU9OXTtcbiAgICAgIHJldHVybiB2YWx1ZSA/IHBhcnNlSW50KHZhbHVlKSA6IHVuZGVmaW5lZDtcbiAgICB9KSgpLFxuICAgIG1heEl0ZW1zOiAoKCkgPT4ge1xuICAgICAgY29uc3QgdmFsdWUgPSBwcm9jZXNzLmVudltSRVNPVVJDRV9FTlZfQ09ORklHLk1BWF9JVEVNU107XG4gICAgICByZXR1cm4gdmFsdWUgPyBwYXJzZUludCh2YWx1ZSkgOiB1bmRlZmluZWQ7XG4gICAgfSkoKSxcbiAgfTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==