c3e919e2d920d257e89be9c8b78363e9
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const child_process_1 = require("child_process");
const timers_1 = require("timers");
const mockN8nServer_1 = require("../mocks/mockN8nServer");
const path = __importStar(require("path"));
// Use process.cwd() + relative path for Jest compatibility
const testDir = path.join(process.cwd(), 'tests', 'e2e');
/**
 * End-to-End tests for MCP protocol compliance
 * Tests the FastMCP server implementation against the MCP specification
 */
(0, globals_1.describe)('MCP Protocol E2E Tests', () => {
    let mockN8nServer;
    let mcpServerProcess;
    const mockServerPort = 3001;
    const mcpServerTimeout = 10000;
    (0, globals_1.beforeAll)(async () => {
        // Start mock n8n server
        mockN8nServer = new mockN8nServer_1.MockN8nServer(mockServerPort);
        await mockN8nServer.start();
        console.log('Mock n8n server started for E2E tests');
    }, 15000);
    (0, globals_1.afterAll)(async () => {
        // Stop mock n8n server
        if (mockN8nServer) {
            await mockN8nServer.stop();
        }
        console.log('Mock n8n server stopped');
    }, 10000);
    (0, globals_1.beforeEach)(() => {
        // Clean up any existing MCP server process
        if (mcpServerProcess) {
            mcpServerProcess.kill('SIGTERM');
            mcpServerProcess = null;
        }
    });
    (0, globals_1.afterEach)(() => {
        // Ensure MCP server process is terminated
        if (mcpServerProcess) {
            mcpServerProcess.kill('SIGTERM');
            mcpServerProcess = null;
        }
    });
    (0, globals_1.describe)('MCP Server Initialization', () => {
        (0, globals_1.it)('should start MCP server successfully with stdio transport', async () => {
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            const startServer = () => {
                return new Promise((resolve, reject) => {
                    mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                        env: {
                            ...process.env,
                            N8N_BASE_URL: mockN8nServer.getUrl(),
                            N8N_API_KEY: 'test-api-key',
                            N8N_MCP_TRANSPORT: 'stdio',
                        },
                        stdio: ['pipe', 'pipe', 'pipe'],
                    });
                    let hasResolved = false;
                    let initTimeout = undefined;
                    const cleanup = () => {
                        if (initTimeout) {
                            (0, timers_1.clearTimeout)(initTimeout);
                        }
                    };
                    mcpServerProcess.stdout?.on('data', data => {
                        const output = data.toString();
                        console.log('MCP Server stdout:', output);
                        // Look for initialization success indicators
                        if (output.includes('Server ready') || output.includes('listening') || !hasResolved) {
                            hasResolved = true;
                            cleanup();
                            resolve();
                        }
                    });
                    mcpServerProcess.stderr?.on('data', data => {
                        const error = data.toString();
                        console.error('MCP Server stderr:', error);
                        if (error.includes('Error') || error.includes('EADDRINUSE')) {
                            cleanup();
                            reject(new Error(`MCP server failed to start: ${error}`));
                        }
                    });
                    mcpServerProcess.on('error', error => {
                        cleanup();
                        reject(new Error(`Failed to spawn MCP server: ${error.message}`));
                    });
                    mcpServerProcess.on('exit', (code, signal) => {
                        if (code !== 0 && code !== null && !hasResolved) {
                            cleanup();
                            reject(new Error(`MCP server exited with code ${code}, signal ${signal}`));
                        }
                    });
                    // Set timeout for server initialization
                    initTimeout = (0, timers_1.setTimeout)(() => {
                        if (!hasResolved) {
                            hasResolved = true;
                            cleanup();
                            resolve(); // Assume success if no explicit errors
                        }
                    }, 5000);
                });
            };
            await (0, globals_1.expect)(startServer()).resolves.not.toThrow();
            (0, globals_1.expect)(mcpServerProcess).toBeDefined();
            (0, globals_1.expect)(mcpServerProcess.pid).toBeGreaterThan(0);
        }, mcpServerTimeout);
        (0, globals_1.it)('should handle MCP initialization protocol', async () => {
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            const testInitialization = () => {
                return new Promise((resolve, reject) => {
                    mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                        env: {
                            ...process.env,
                            N8N_BASE_URL: mockN8nServer.getUrl(),
                            N8N_API_KEY: 'test-api-key',
                            N8N_MCP_TRANSPORT: 'stdio',
                        },
                        stdio: ['pipe', 'pipe', 'pipe'],
                    });
                    let responseData = '';
                    let hasResolved = false;
                    const cleanup = () => {
                        if (!hasResolved) {
                            hasResolved = true;
                        }
                    };
                    mcpServerProcess.stdout?.on('data', data => {
                        responseData += data.toString();
                        // Look for JSON-RPC response
                        try {
                            const lines = responseData.split('\n').filter(line => line.trim());
                            for (const line of lines) {
                                if (line.startsWith('{')) {
                                    const response = JSON.parse(line);
                                    if (response.result && response.result.capabilities) {
                                        cleanup();
                                        resolve(response);
                                        return;
                                    }
                                }
                            }
                        }
                        catch (e) {
                            // Continue processing
                        }
                    });
                    mcpServerProcess.stderr?.on('data', data => {
                        console.error('MCP Server stderr:', data.toString());
                    });
                    mcpServerProcess.on('error', error => {
                        cleanup();
                        reject(error);
                    });
                    // Send MCP initialization request
                    const initRequest = {
                        jsonrpc: '2.0',
                        id: 1,
                        method: 'initialize',
                        params: {
                            protocolVersion: '2024-11-05',
                            capabilities: {
                                tools: {},
                                resources: {},
                            },
                            clientInfo: {
                                name: 'e2e-test-client',
                                version: '1.0.0',
                            },
                        },
                    };
                    (0, timers_1.setTimeout)(() => {
                        if (mcpServerProcess && mcpServerProcess.stdin) {
                            mcpServerProcess.stdin.write(JSON.stringify(initRequest) + '\n');
                        }
                    }, 1000);
                    // Timeout for initialization
                    (0, timers_1.setTimeout)(() => {
                        if (!hasResolved) {
                            cleanup();
                            reject(new Error('MCP initialization timeout'));
                        }
                    }, 8000);
                });
            };
            const response = await testInitialization();
            // Verify MCP protocol compliance
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(1);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.capabilities).toBeDefined();
            (0, globals_1.expect)(response.result.capabilities.tools).toBeDefined();
            (0, globals_1.expect)(response.result.serverInfo).toBeDefined();
            (0, globals_1.expect)(response.result.serverInfo.name).toBe('n8n-mcp-server');
        }, mcpServerTimeout);
    });
    (0, globals_1.describe)('MCP Tools Protocol', () => {
        let initializedServer;
        (0, globals_1.beforeEach)(async () => {
            // Initialize server for tools testing
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            initializedServer = await new Promise((resolve, reject) => {
                mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                    env: {
                        ...process.env,
                        N8N_BASE_URL: mockN8nServer.getUrl(),
                        N8N_API_KEY: 'test-api-key',
                        N8N_MCP_TRANSPORT: 'stdio',
                    },
                    stdio: ['pipe', 'pipe', 'pipe'],
                });
                let responseData = '';
                let isInitialized = false;
                mcpServerProcess.stdout?.on('data', data => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.result && response.result.capabilities && !isInitialized) {
                                    isInitialized = true;
                                    resolve(mcpServerProcess);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                });
                mcpServerProcess.on('error', reject);
                // Send initialization
                (0, timers_1.setTimeout)(() => {
                    const initRequest = {
                        jsonrpc: '2.0',
                        id: 1,
                        method: 'initialize',
                        params: {
                            protocolVersion: '2024-11-05',
                            capabilities: { tools: {}, resources: {} },
                            clientInfo: { name: 'e2e-test-client', version: '1.0.0' },
                        },
                    };
                    mcpServerProcess.stdin?.write(JSON.stringify(initRequest) + '\n');
                }, 1000);
                (0, timers_1.setTimeout)(() => {
                    if (!isInitialized) {
                        reject(new Error('Server initialization timeout'));
                    }
                }, 8000);
            });
        }, mcpServerTimeout);
        (0, globals_1.it)('should list available tools', async () => {
            const listToolsRequest = {
                jsonrpc: '2.0',
                id: 2,
                method: 'tools/list',
                params: {},
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 2) {
                                    if (mcpServerProcess && mcpServerProcess.stdout) {
                                        mcpServerProcess.stdout.off('data', dataHandler);
                                    }
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(listToolsRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    if (mcpServerProcess && mcpServerProcess.stdout) {
                        mcpServerProcess.stdout.off('data', dataHandler);
                    }
                    reject(new Error('Tools list timeout'));
                }, 5000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(2);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.tools).toBeDefined();
            (0, globals_1.expect)(Array.isArray(response.result.tools)).toBe(true);
            // Verify essential n8n tools are present
            const tools = response.result.tools;
            const toolNames = tools.map((tool) => tool.name);
            (0, globals_1.expect)(toolNames).toContain('init-n8n');
            (0, globals_1.expect)(toolNames).toContain('list-workflows');
            (0, globals_1.expect)(toolNames).toContain('get-workflow');
            (0, globals_1.expect)(toolNames).toContain('create-workflow');
        });
        (0, globals_1.it)('should execute init-n8n tool successfully', async () => {
            const toolCallRequest = {
                jsonrpc: '2.0',
                id: 3,
                method: 'tools/call',
                params: {
                    name: 'init-n8n',
                    arguments: {
                        baseUrl: mockN8nServer.getUrl(),
                        apiKey: 'test-api-key',
                    },
                },
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 3) {
                                    if (mcpServerProcess && mcpServerProcess.stdout) {
                                        mcpServerProcess.stdout.off('data', dataHandler);
                                    }
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(toolCallRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    if (mcpServerProcess && mcpServerProcess.stdout) {
                        mcpServerProcess.stdout.off('data', dataHandler);
                    }
                    reject(new Error('Tool call timeout'));
                }, 8000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(3);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.content).toBeDefined();
            (0, globals_1.expect)(Array.isArray(response.result.content)).toBe(true);
            (0, globals_1.expect)(response.result.content[0].type).toBe('text');
            (0, globals_1.expect)(response.result.content[0].text).toContain('Successfully connected');
        });
        (0, globals_1.it)('should execute list-workflows tool successfully', async () => {
            // First initialize n8n
            const initRequest = {
                jsonrpc: '2.0',
                id: 4,
                method: 'tools/call',
                params: {
                    name: 'init-n8n',
                    arguments: {
                        baseUrl: mockN8nServer.getUrl(),
                        apiKey: 'test-api-key',
                    },
                },
            };
            await new Promise(resolve => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 4) {
                                    if (mcpServerProcess && mcpServerProcess.stdout) {
                                        mcpServerProcess.stdout.off('data', dataHandler);
                                    }
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(initRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    if (mcpServerProcess && mcpServerProcess.stdout) {
                        mcpServerProcess.stdout.off('data', dataHandler);
                    }
                    resolve(null);
                }, 5000);
            });
            // Now test list-workflows
            const listWorkflowsRequest = {
                jsonrpc: '2.0',
                id: 5,
                method: 'tools/call',
                params: {
                    name: 'list-workflows',
                    arguments: {
                        limit: 10,
                    },
                },
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 5) {
                                    if (mcpServerProcess && mcpServerProcess.stdout) {
                                        mcpServerProcess.stdout.off('data', dataHandler);
                                    }
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(listWorkflowsRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    if (mcpServerProcess && mcpServerProcess.stdout) {
                        mcpServerProcess.stdout.off('data', dataHandler);
                    }
                    reject(new Error('List workflows timeout'));
                }, 8000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(5);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.content).toBeDefined();
            (0, globals_1.expect)(Array.isArray(response.result.content)).toBe(true);
            (0, globals_1.expect)(response.result.content[0].type).toBe('text');
            // Verify response contains workflow data
            const responseText = response.result.content[0].text;
            (0, globals_1.expect)(responseText).toContain('workflow(s)');
            (0, globals_1.expect)(responseText).toContain('Test Workflow');
        });
    });
    (0, globals_1.describe)('Error Handling', () => {
        (0, globals_1.it)('should handle invalid tool names gracefully', async () => {
            // Initialize server first
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                env: {
                    ...process.env,
                    N8N_BASE_URL: mockN8nServer.getUrl(),
                    N8N_API_KEY: 'test-api-key',
                    N8N_MCP_TRANSPORT: 'stdio',
                },
                stdio: ['pipe', 'pipe', 'pipe'],
            });
            // Wait for initialization
            await new Promise(resolve => {
                (0, timers_1.setTimeout)(() => {
                    const initRequest = {
                        jsonrpc: '2.0',
                        id: 1,
                        method: 'initialize',
                        params: {
                            protocolVersion: '2024-11-05',
                            capabilities: { tools: {}, resources: {} },
                            clientInfo: { name: 'e2e-test-client', version: '1.0.0' },
                        },
                    };
                    mcpServerProcess.stdin?.write(JSON.stringify(initRequest) + '\n');
                    (0, timers_1.setTimeout)(resolve, 2000);
                }, 1000);
            });
            // Test invalid tool call
            const invalidToolRequest = {
                jsonrpc: '2.0',
                id: 2,
                method: 'tools/call',
                params: {
                    name: 'nonexistent-tool',
                    arguments: {},
                },
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 2) {
                                    if (mcpServerProcess && mcpServerProcess.stdout) {
                                        mcpServerProcess.stdout.off('data', dataHandler);
                                    }
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(invalidToolRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    if (mcpServerProcess && mcpServerProcess.stdout) {
                        mcpServerProcess.stdout.off('data', dataHandler);
                    }
                    reject(new Error('Invalid tool call timeout'));
                }, 5000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(2);
            (0, globals_1.expect)(response.error).toBeDefined();
            (0, globals_1.expect)(response.error.code).toBeDefined();
            (0, globals_1.expect)(response.error.message).toContain('Unknown tool');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2plcmVteXBhcmtlci9EZXNrdG9wL0NsYXVkZSBDb2RpbmcgUHJvamVjdHMvbjhuLW1jcC1zZXJ2ZXIvdGVzdHMvZTJlL21jcC1wcm90b2NvbC50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQWlHO0FBQ2pHLGlEQUFvRDtBQUNwRCxtQ0FBa0Q7QUFDbEQsMERBQXVEO0FBQ3ZELDJDQUE2QjtBQUU3QiwyREFBMkQ7QUFDM0QsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBRXpEOzs7R0FHRztBQUNILElBQUEsa0JBQVEsRUFBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUU7SUFDdEMsSUFBSSxhQUE0QixDQUFDO0lBQ2pDLElBQUksZ0JBQThCLENBQUM7SUFDbkMsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDO0lBQzVCLE1BQU0sZ0JBQWdCLEdBQUcsS0FBSyxDQUFDO0lBRS9CLElBQUEsbUJBQVMsRUFBQyxLQUFLLElBQUksRUFBRTtRQUNuQix3QkFBd0I7UUFDeEIsYUFBYSxHQUFHLElBQUksNkJBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNsRCxNQUFNLGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUU1QixPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxDQUFDLENBQUM7SUFDdkQsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBRVYsSUFBQSxrQkFBUSxFQUFDLEtBQUssSUFBSSxFQUFFO1FBQ2xCLHVCQUF1QjtRQUN2QixJQUFJLGFBQWEsRUFBRSxDQUFDO1lBQ2xCLE1BQU0sYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQzdCLENBQUM7UUFFRCxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUM7SUFDekMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBRVYsSUFBQSxv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QUFDO29CQUNELE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pELENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztZQUNYLENBQUMsQ0FBQyxDQUFDO1lBRUgsSUFBQSxnQkFBTSxFQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQy9CLElBQUEsZ0JBQU0sRUFBRSxRQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM5QyxJQUFBLGdCQUFNLEVBQUUsUUFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDckMsSUFBQSxnQkFBTSxFQUFFLFFBQWdCLENBQUMsS0FBSyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFDOUMsSUFBQSxnQkFBTSxFQUFFLFFBQWdCLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQ25ELElBQUEsZ0JBQU0sRUFBRSxRQUFnQixDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7UUFDcEUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9qZXJlbXlwYXJrZXIvRGVza3RvcC9DbGF1ZGUgQ29kaW5nIFByb2plY3RzL244bi1tY3Atc2VydmVyL3Rlc3RzL2UyZS9tY3AtcHJvdG9jb2wudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXNjcmliZSwgYmVmb3JlQWxsLCBhZnRlckFsbCwgYmVmb3JlRWFjaCwgYWZ0ZXJFYWNoLCBpdCwgZXhwZWN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgeyBzcGF3biwgQ2hpbGRQcm9jZXNzIH0gZnJvbSAnY2hpbGRfcHJvY2Vzcyc7XG5pbXBvcnQgeyBzZXRUaW1lb3V0LCBjbGVhclRpbWVvdXQgfSBmcm9tICd0aW1lcnMnO1xuaW1wb3J0IHsgTW9ja044blNlcnZlciB9IGZyb20gJy4uL21vY2tzL21vY2tOOG5TZXJ2ZXInO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdwYXRoJztcblxuLy8gVXNlIHByb2Nlc3MuY3dkKCkgKyByZWxhdGl2ZSBwYXRoIGZvciBKZXN0IGNvbXBhdGliaWxpdHlcbmNvbnN0IHRlc3REaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3Rlc3RzJywgJ2UyZScpO1xuXG4vKipcbiAqIEVuZC10by1FbmQgdGVzdHMgZm9yIE1DUCBwcm90b2NvbCBjb21wbGlhbmNlXG4gKiBUZXN0cyB0aGUgRmFzdE1DUCBzZXJ2ZXIgaW1wbGVtZW50YXRpb24gYWdhaW5zdCB0aGUgTUNQIHNwZWNpZmljYXRpb25cbiAqL1xuZGVzY3JpYmUoJ01DUCBQcm90b2NvbCBFMkUgVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBtb2NrTjhuU2VydmVyOiBNb2NrTjhuU2VydmVyO1xuICBsZXQgbWNwU2VydmVyUHJvY2VzczogQ2hpbGRQcm9jZXNzO1xuICBjb25zdCBtb2NrU2VydmVyUG9ydCA9IDMwMDE7XG4gIGNvbnN0IG1jcFNlcnZlclRpbWVvdXQgPSAxMDAwMDtcblxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIC8vIFN0YXJ0IG1vY2sgbjhuIHNlcnZlclxuICAgIG1vY2tOOG5TZXJ2ZXIgPSBuZXcgTW9ja044blNlcnZlcihtb2NrU2VydmVyUG9ydCk7XG4gICAgYXdhaXQgbW9ja044blNlcnZlci5zdGFydCgpO1xuXG4gICAgY29uc29sZS5sb2coJ01vY2sgbjhuIHNlcnZlciBzdGFydGVkIGZvciBFMkUgdGVzdHMnKTtcbiAgfSwgMTUwMDApO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBTdG9wIG1vY2sgbjhuIHNlcnZlclxuICAgIGlmIChtb2NrTjhuU2VydmVyKSB7XG4gICAgICBhd2FpdCBtb2NrTjhuU2VydmVyLnN0b3AoKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnTW9jayBuOG4gc2VydmVyIHN0b3BwZWQnKTtcbiAgfSwgMTAwMDApO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIENsZWFuIHVwIGFueSBleGlzdGluZyBNQ1Agc2VydmVyIHByb2Nlc3NcbiAgICBpZiAobWNwU2VydmVyUHJvY2Vzcykge1xuICAgICAgbWNwU2VydmVyUHJvY2Vzcy5raWxsKCdTSUdURVJNJyk7XG4gICAgICBtY3BTZXJ2ZXJQcm9jZXNzID0gbnVsbCBhcyBhbnk7XG4gICAgfVxuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIC8vIEVuc3VyZSBNQ1Agc2VydmVyIHByb2Nlc3MgaXMgdGVybWluYXRlZFxuICAgIGlmIChtY3BTZXJ2ZXJQcm9jZXNzKSB7XG4gICAgICBtY3BTZXJ2ZXJQcm9jZXNzLmtpbGwoJ1NJR1RFUk0nKTtcbiAgICAgIG1jcFNlcnZlclByb2Nlc3MgPSBudWxsIGFzIGFueTtcbiAgICB9XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNQ1AgU2VydmVyIEluaXRpYWxpemF0aW9uJywgKCkgPT4ge1xuICAgIGl0KFxuICAgICAgJ3Nob3VsZCBzdGFydCBNQ1Agc2VydmVyIHN1Y2Nlc3NmdWxseSB3aXRoIHN0ZGlvIHRyYW5zcG9ydCcsXG4gICAgICBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlcnZlclBhdGggPSBwYXRoLmpvaW4odGVzdERpciwgJy4uLy4uL2J1aWxkL2luZGV4LWZhc3RtY3AuanMnKTtcblxuICAgICAgICBjb25zdCBzdGFydFNlcnZlciA9ICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgbWNwU2VydmVyUHJvY2VzcyA9IHNwYXduKCdub2RlJywgW3NlcnZlclBhdGhdLCB7XG4gICAgICAgICAgICAgIGVudjoge1xuICAgICAgICAgICAgICAgIC4uLnByb2Nlc3MuZW52LFxuICAgICAgICAgICAgICAgIE44Tl9CQVNFX1VSTDogbW9ja044blNlcnZlci5nZXRVcmwoKSxcbiAgICAgICAgICAgICAgICBOOE5fQVBJX0tFWTogJ3Rlc3QtYXBpLWtleScsXG4gICAgICAgICAgICAgICAgTjhOX01DUF9UUkFOU1BPUlQ6ICdzdGRpbycsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHN0ZGlvOiBbJ3BpcGUnLCAncGlwZScsICdwaXBlJ10sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IGhhc1Jlc29sdmVkID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQgaW5pdFRpbWVvdXQ6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+IHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4ge1xuICAgICAgICAgICAgICBpZiAoaW5pdFRpbWVvdXQpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoaW5pdFRpbWVvdXQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dD8ub24oJ2RhdGEnLCBkYXRhID0+IHtcbiAgICAgICAgICAgICAgY29uc3Qgb3V0cHV0ID0gZGF0YS50b1N0cmluZygpO1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTUNQIFNlcnZlciBzdGRvdXQ6Jywgb3V0cHV0KTtcblxuICAgICAgICAgICAgICAvLyBMb29rIGZvciBpbml0aWFsaXphdGlvbiBzdWNjZXNzIGluZGljYXRvcnNcbiAgICAgICAgICAgICAgaWYgKG91dHB1dC5pbmNsdWRlcygnU2VydmVyIHJlYWR5JykgfHwgb3V0cHV0LmluY2x1ZGVzKCdsaXN0ZW5pbmcnKSB8fCAhaGFzUmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICBoYXNSZXNvbHZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3RkZXJyPy5vbignZGF0YScsIGRhdGEgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBlcnJvciA9IGRhdGEudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTUNQIFNlcnZlciBzdGRlcnI6JywgZXJyb3IpO1xuXG4gICAgICAgICAgICAgIGlmIChlcnJvci5pbmNsdWRlcygnRXJyb3InKSB8fCBlcnJvci5pbmNsdWRlcygnRUFERFJJTlVTRScpKSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYE1DUCBzZXJ2ZXIgZmFpbGVkIHRvIHN0YXJ0OiAke2Vycm9yfWApKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Mub24oJ2Vycm9yJywgZXJyb3IgPT4ge1xuICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYEZhaWxlZCB0byBzcGF3biBNQ1Agc2VydmVyOiAke2Vycm9yLm1lc3NhZ2V9YCkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Mub24oJ2V4aXQnLCAoY29kZSwgc2lnbmFsKSA9PiB7XG4gICAgICAgICAgICAgIGlmIChjb2RlICE9PSAwICYmIGNvZGUgIT09IG51bGwgJiYgIWhhc1Jlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYE1DUCBzZXJ2ZXIgZXhpdGVkIHdpdGggY29kZSAke2NvZGV9LCBzaWduYWwgJHtzaWduYWx9YCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gU2V0IHRpbWVvdXQgZm9yIHNlcnZlciBpbml0aWFsaXphdGlvblxuICAgICAgICAgICAgaW5pdFRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKCFoYXNSZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgIGhhc1Jlc29sdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpOyAvLyBBc3N1bWUgc3VjY2VzcyBpZiBubyBleHBsaWNpdCBlcnJvcnNcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgNTAwMCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgYXdhaXQgZXhwZWN0KHN0YXJ0U2VydmVyKCkpLnJlc29sdmVzLm5vdC50b1Rocm93KCk7XG4gICAgICAgIGV4cGVjdChtY3BTZXJ2ZXJQcm9jZXNzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QobWNwU2VydmVyUHJvY2Vzcy5waWQpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIH0sXG4gICAgICBtY3BTZXJ2ZXJUaW1lb3V0XG4gICAgKTtcblxuICAgIGl0KFxuICAgICAgJ3Nob3VsZCBoYW5kbGUgTUNQIGluaXRpYWxpemF0aW9uIHByb3RvY29sJyxcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VydmVyUGF0aCA9IHBhdGguam9pbih0ZXN0RGlyLCAnLi4vLi4vYnVpbGQvaW5kZXgtZmFzdG1jcC5qcycpO1xuXG4gICAgICAgIGNvbnN0IHRlc3RJbml0aWFsaXphdGlvbiA9ICgpOiBQcm9taXNlPGFueT4gPT4ge1xuICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzID0gc3Bhd24oJ25vZGUnLCBbc2VydmVyUGF0aF0sIHtcbiAgICAgICAgICAgICAgZW52OiB7XG4gICAgICAgICAgICAgICAgLi4ucHJvY2Vzcy5lbnYsXG4gICAgICAgICAgICAgICAgTjhOX0JBU0VfVVJMOiBtb2NrTjhuU2VydmVyLmdldFVybCgpLFxuICAgICAgICAgICAgICAgIE44Tl9BUElfS0VZOiAndGVzdC1hcGkta2V5JyxcbiAgICAgICAgICAgICAgICBOOE5fTUNQX1RSQU5TUE9SVDogJ3N0ZGlvJyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgc3RkaW86IFsncGlwZScsICdwaXBlJywgJ3BpcGUnXSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgcmVzcG9uc2VEYXRhID0gJyc7XG4gICAgICAgICAgICBsZXQgaGFzUmVzb2x2ZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKCFoYXNSZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgIGhhc1Jlc29sdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9uKCdkYXRhJywgZGF0YSA9PiB7XG4gICAgICAgICAgICAgIHJlc3BvbnNlRGF0YSArPSBkYXRhLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICAgICAgLy8gTG9vayBmb3IgSlNPTi1SUEMgcmVzcG9uc2VcbiAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IHJlc3BvbnNlRGF0YS5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgneycpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCAmJiByZXNwb25zZS5yZXN1bHQuY2FwYWJpbGl0aWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIENvbnRpbnVlIHByb2Nlc3NpbmdcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3RkZXJyPy5vbignZGF0YScsIGRhdGEgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNQ1AgU2VydmVyIHN0ZGVycjonLCBkYXRhLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Mub24oJ2Vycm9yJywgZXJyb3IgPT4ge1xuICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gU2VuZCBNQ1AgaW5pdGlhbGl6YXRpb24gcmVxdWVzdFxuICAgICAgICAgICAgY29uc3QgaW5pdFJlcXVlc3QgPSB7XG4gICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgICAgICBpZDogMSxcbiAgICAgICAgICAgICAgbWV0aG9kOiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICAgIHByb3RvY29sVmVyc2lvbjogJzIwMjQtMTEtMDUnLFxuICAgICAgICAgICAgICAgIGNhcGFiaWxpdGllczoge1xuICAgICAgICAgICAgICAgICAgdG9vbHM6IHt9LFxuICAgICAgICAgICAgICAgICAgcmVzb3VyY2VzOiB7fSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNsaWVudEluZm86IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6ICdlMmUtdGVzdC1jbGllbnQnLFxuICAgICAgICAgICAgICAgICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGlmIChtY3BTZXJ2ZXJQcm9jZXNzICYmIG1jcFNlcnZlclByb2Nlc3Muc3RkaW4pIHtcbiAgICAgICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGluLndyaXRlKEpTT04uc3RyaW5naWZ5KGluaXRSZXF1ZXN0KSArICdcXG4nKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgMTAwMCk7XG5cbiAgICAgICAgICAgIC8vIFRpbWVvdXQgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKCFoYXNSZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdNQ1AgaW5pdGlhbGl6YXRpb24gdGltZW91dCcpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgODAwMCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0SW5pdGlhbGl6YXRpb24oKTtcblxuICAgICAgICAvLyBWZXJpZnkgTUNQIHByb3RvY29sIGNvbXBsaWFuY2VcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuanNvbnJwYykudG9CZSgnMi4wJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5pZCkudG9CZSgxKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnJlc3VsdC5jYXBhYmlsaXRpZXMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5yZXN1bHQuY2FwYWJpbGl0aWVzLnRvb2xzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UucmVzdWx0LnNlcnZlckluZm8pLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5yZXN1bHQuc2VydmVySW5mby5uYW1lKS50b0JlKCduOG4tbWNwLXNlcnZlcicpO1xuICAgICAgfSxcbiAgICAgIG1jcFNlcnZlclRpbWVvdXRcbiAgICApO1xuICB9KTtcblxuICBkZXNjcmliZSgnTUNQIFRvb2xzIFByb3RvY29sJywgKCkgPT4ge1xuICAgIGxldCBpbml0aWFsaXplZFNlcnZlcjogYW55O1xuXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XG4gICAgICAvLyBJbml0aWFsaXplIHNlcnZlciBmb3IgdG9vbHMgdGVzdGluZ1xuICAgICAgY29uc3Qgc2VydmVyUGF0aCA9IHBhdGguam9pbih0ZXN0RGlyLCAnLi4vLi4vYnVpbGQvaW5kZXgtZmFzdG1jcC5qcycpO1xuXG4gICAgICBpbml0aWFsaXplZFNlcnZlciA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgbWNwU2VydmVyUHJvY2VzcyA9IHNwYXduKCdub2RlJywgW3NlcnZlclBhdGhdLCB7XG4gICAgICAgICAgZW52OiB7XG4gICAgICAgICAgICAuLi5wcm9jZXNzLmVudixcbiAgICAgICAgICAgIE44Tl9CQVNFX1VSTDogbW9ja044blNlcnZlci5nZXRVcmwoKSxcbiAgICAgICAgICAgIE44Tl9BUElfS0VZOiAndGVzdC1hcGkta2V5JyxcbiAgICAgICAgICAgIE44Tl9NQ1BfVFJBTlNQT1JUOiAnc3RkaW8nLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3RkaW86IFsncGlwZScsICdwaXBlJywgJ3BpcGUnXSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9ICcnO1xuICAgICAgICBsZXQgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuXG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vbignZGF0YScsIGRhdGEgPT4ge1xuICAgICAgICAgIHJlc3BvbnNlRGF0YSArPSBkYXRhLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZURhdGEuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCd7JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UobGluZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdCAmJiByZXNwb25zZS5yZXN1bHQuY2FwYWJpbGl0aWVzICYmICFpc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICBpc0luaXRpYWxpemVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUobWNwU2VydmVyUHJvY2Vzcyk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gQ29udGludWUgcHJvY2Vzc2luZ1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5vbignZXJyb3InLCByZWplY3QpO1xuXG4gICAgICAgIC8vIFNlbmQgaW5pdGlhbGl6YXRpb25cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgY29uc3QgaW5pdFJlcXVlc3QgPSB7XG4gICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgICAgbWV0aG9kOiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgcHJvdG9jb2xWZXJzaW9uOiAnMjAyNC0xMS0wNScsXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogeyB0b29sczoge30sIHJlc291cmNlczoge30gfSxcbiAgICAgICAgICAgICAgY2xpZW50SW5mbzogeyBuYW1lOiAnZTJlLXRlc3QtY2xpZW50JywgdmVyc2lvbjogJzEuMC4wJyB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3RkaW4/LndyaXRlKEpTT04uc3RyaW5naWZ5KGluaXRSZXF1ZXN0KSArICdcXG4nKTtcbiAgICAgICAgfSwgMTAwMCk7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgaWYgKCFpc0luaXRpYWxpemVkKSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdTZXJ2ZXIgaW5pdGlhbGl6YXRpb24gdGltZW91dCcpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIDgwMDApO1xuICAgICAgfSk7XG4gICAgfSwgbWNwU2VydmVyVGltZW91dCk7XG5cbiAgICBpdCgnc2hvdWxkIGxpc3QgYXZhaWxhYmxlIHRvb2xzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbGlzdFRvb2xzUmVxdWVzdCA9IHtcbiAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgIGlkOiAyLFxuICAgICAgICBtZXRob2Q6ICd0b29scy9saXN0JyxcbiAgICAgICAgcGFyYW1zOiB7fSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgcmVzcG9uc2VEYXRhID0gJyc7XG5cbiAgICAgICAgY29uc3QgZGF0YUhhbmRsZXIgPSAoZGF0YTogQnVmZmVyKSA9PiB7XG4gICAgICAgICAgcmVzcG9uc2VEYXRhICs9IGRhdGEudG9TdHJpbmcoKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lcyA9IHJlc3BvbnNlRGF0YS5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ3snKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShsaW5lKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuaWQgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChtY3BTZXJ2ZXJQcm9jZXNzICYmIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Lm9mZignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIHByb2Nlc3NpbmdcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9uKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGluPy53cml0ZShKU09OLnN0cmluZ2lmeShsaXN0VG9vbHNSZXF1ZXN0KSArICdcXG4nKTtcblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBpZiAobWNwU2VydmVyUHJvY2VzcyAmJiBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dCkge1xuICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQub2ZmKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdUb29scyBsaXN0IHRpbWVvdXQnKSk7XG4gICAgICAgIH0sIDUwMDApO1xuICAgICAgfSk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5qc29ucnBjKS50b0JlKCcyLjAnKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5pZCkudG9CZSgyKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5yZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0LnRvb2xzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0LnRvb2xzKSkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gVmVyaWZ5IGVzc2VudGlhbCBuOG4gdG9vbHMgYXJlIHByZXNlbnRcbiAgICAgIGNvbnN0IHRvb2xzID0gKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0LnRvb2xzO1xuICAgICAgY29uc3QgdG9vbE5hbWVzID0gdG9vbHMubWFwKCh0b29sOiBhbnkpID0+IHRvb2wubmFtZSk7XG5cbiAgICAgIGV4cGVjdCh0b29sTmFtZXMpLnRvQ29udGFpbignaW5pdC1uOG4nKTtcbiAgICAgIGV4cGVjdCh0b29sTmFtZXMpLnRvQ29udGFpbignbGlzdC13b3JrZmxvd3MnKTtcbiAgICAgIGV4cGVjdCh0b29sTmFtZXMpLnRvQ29udGFpbignZ2V0LXdvcmtmbG93Jyk7XG4gICAgICBleHBlY3QodG9vbE5hbWVzKS50b0NvbnRhaW4oJ2NyZWF0ZS13b3JrZmxvdycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleGVjdXRlIGluaXQtbjhuIHRvb2wgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdG9vbENhbGxSZXF1ZXN0ID0ge1xuICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgaWQ6IDMsXG4gICAgICAgIG1ldGhvZDogJ3Rvb2xzL2NhbGwnLFxuICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICBuYW1lOiAnaW5pdC1uOG4nLFxuICAgICAgICAgIGFyZ3VtZW50czoge1xuICAgICAgICAgICAgYmFzZVVybDogbW9ja044blNlcnZlci5nZXRVcmwoKSxcbiAgICAgICAgICAgIGFwaUtleTogJ3Rlc3QtYXBpLWtleScsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgcmVzcG9uc2VEYXRhID0gJyc7XG5cbiAgICAgICAgY29uc3QgZGF0YUhhbmRsZXIgPSAoZGF0YTogQnVmZmVyKSA9PiB7XG4gICAgICAgICAgcmVzcG9uc2VEYXRhICs9IGRhdGEudG9TdHJpbmcoKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lcyA9IHJlc3BvbnNlRGF0YS5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ3snKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShsaW5lKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuaWQgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChtY3BTZXJ2ZXJQcm9jZXNzICYmIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Lm9mZignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIHByb2Nlc3NpbmdcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9uKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGluPy53cml0ZShKU09OLnN0cmluZ2lmeSh0b29sQ2FsbFJlcXVlc3QpICsgJ1xcbicpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGlmIChtY3BTZXJ2ZXJQcm9jZXNzICYmIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0KSB7XG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dC5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ1Rvb2wgY2FsbCB0aW1lb3V0JykpO1xuICAgICAgICB9LCA4MDAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuanNvbnJwYykudG9CZSgnMi4wJyk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuaWQpLnRvQmUoMyk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC5jb250ZW50KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0LmNvbnRlbnQpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC5jb250ZW50WzBdLnR5cGUpLnRvQmUoJ3RleHQnKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5yZXN1bHQuY29udGVudFswXS50ZXh0KS50b0NvbnRhaW4oJ1N1Y2Nlc3NmdWxseSBjb25uZWN0ZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBsaXN0LXdvcmtmbG93cyB0b29sIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEZpcnN0IGluaXRpYWxpemUgbjhuXG4gICAgICBjb25zdCBpbml0UmVxdWVzdCA9IHtcbiAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgIGlkOiA0LFxuICAgICAgICBtZXRob2Q6ICd0b29scy9jYWxsJyxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgbmFtZTogJ2luaXQtbjhuJyxcbiAgICAgICAgICBhcmd1bWVudHM6IHtcbiAgICAgICAgICAgIGJhc2VVcmw6IG1vY2tOOG5TZXJ2ZXIuZ2V0VXJsKCksXG4gICAgICAgICAgICBhcGlLZXk6ICd0ZXN0LWFwaS1rZXknLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9ICcnO1xuXG4gICAgICAgIGNvbnN0IGRhdGFIYW5kbGVyID0gKGRhdGE6IEJ1ZmZlcikgPT4ge1xuICAgICAgICAgIHJlc3BvbnNlRGF0YSArPSBkYXRhLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZURhdGEuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCd7JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UobGluZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmlkID09PSA0KSB7XG4gICAgICAgICAgICAgICAgICBpZiAobWNwU2VydmVyUHJvY2VzcyAmJiBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dCkge1xuICAgICAgICAgICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dC5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBDb250aW51ZSBwcm9jZXNzaW5nXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vbignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRpbj8ud3JpdGUoSlNPTi5zdHJpbmdpZnkoaW5pdFJlcXVlc3QpICsgJ1xcbicpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGlmIChtY3BTZXJ2ZXJQcm9jZXNzICYmIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0KSB7XG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dC5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlc29sdmUobnVsbCk7XG4gICAgICAgIH0sIDUwMDApO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE5vdyB0ZXN0IGxpc3Qtd29ya2Zsb3dzXG4gICAgICBjb25zdCBsaXN0V29ya2Zsb3dzUmVxdWVzdCA9IHtcbiAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgIGlkOiA1LFxuICAgICAgICBtZXRob2Q6ICd0b29scy9jYWxsJyxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgbmFtZTogJ2xpc3Qtd29ya2Zsb3dzJyxcbiAgICAgICAgICBhcmd1bWVudHM6IHtcbiAgICAgICAgICAgIGxpbWl0OiAxMCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGxldCByZXNwb25zZURhdGEgPSAnJztcblxuICAgICAgICBjb25zdCBkYXRhSGFuZGxlciA9IChkYXRhOiBCdWZmZXIpID0+IHtcbiAgICAgICAgICByZXNwb25zZURhdGEgKz0gZGF0YS50b1N0cmluZygpO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2VEYXRhLnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgneycpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKGxpbmUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5pZCA9PT0gNSkge1xuICAgICAgICAgICAgICAgICAgaWYgKG1jcFNlcnZlclByb2Nlc3MgJiYgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQub2ZmKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gQ29udGludWUgcHJvY2Vzc2luZ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dD8ub24oJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3RkaW4/LndyaXRlKEpTT04uc3RyaW5naWZ5KGxpc3RXb3JrZmxvd3NSZXF1ZXN0KSArICdcXG4nKTtcblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBpZiAobWNwU2VydmVyUHJvY2VzcyAmJiBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dCkge1xuICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQub2ZmKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdMaXN0IHdvcmtmbG93cyB0aW1lb3V0JykpO1xuICAgICAgICB9LCA4MDAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuanNvbnJwYykudG9CZSgnMi4wJyk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuaWQpLnRvQmUoNSk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC5jb250ZW50KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0LmNvbnRlbnQpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC5jb250ZW50WzBdLnR5cGUpLnRvQmUoJ3RleHQnKTtcblxuICAgICAgLy8gVmVyaWZ5IHJlc3BvbnNlIGNvbnRhaW5zIHdvcmtmbG93IGRhdGFcbiAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC5jb250ZW50WzBdLnRleHQ7XG4gICAgICBleHBlY3QocmVzcG9uc2VUZXh0KS50b0NvbnRhaW4oJ3dvcmtmbG93KHMpJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2VUZXh0KS50b0NvbnRhaW4oJ1Rlc3QgV29ya2Zsb3cnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgdG9vbCBuYW1lcyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gSW5pdGlhbGl6ZSBzZXJ2ZXIgZmlyc3RcbiAgICAgIGNvbnN0IHNlcnZlclBhdGggPSBwYXRoLmpvaW4odGVzdERpciwgJy4uLy4uL2J1aWxkL2luZGV4LWZhc3RtY3AuanMnKTtcblxuICAgICAgbWNwU2VydmVyUHJvY2VzcyA9IHNwYXduKCdub2RlJywgW3NlcnZlclBhdGhdLCB7XG4gICAgICAgIGVudjoge1xuICAgICAgICAgIC4uLnByb2Nlc3MuZW52LFxuICAgICAgICAgIE44Tl9CQVNFX1VSTDogbW9ja044blNlcnZlci5nZXRVcmwoKSxcbiAgICAgICAgICBOOE5fQVBJX0tFWTogJ3Rlc3QtYXBpLWtleScsXG4gICAgICAgICAgTjhOX01DUF9UUkFOU1BPUlQ6ICdzdGRpbycsXG4gICAgICAgIH0sXG4gICAgICAgIHN0ZGlvOiBbJ3BpcGUnLCAncGlwZScsICdwaXBlJ10sXG4gICAgICB9KTtcblxuICAgICAgLy8gV2FpdCBmb3IgaW5pdGlhbGl6YXRpb25cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBjb25zdCBpbml0UmVxdWVzdCA9IHtcbiAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICAgICAgaWQ6IDEsXG4gICAgICAgICAgICBtZXRob2Q6ICdpbml0aWFsaXplJyxcbiAgICAgICAgICAgIHBhcmFtczoge1xuICAgICAgICAgICAgICBwcm90b2NvbFZlcnNpb246ICcyMDI0LTExLTA1JyxcbiAgICAgICAgICAgICAgY2FwYWJpbGl0aWVzOiB7IHRvb2xzOiB7fSwgcmVzb3VyY2VzOiB7fSB9LFxuICAgICAgICAgICAgICBjbGllbnRJbmZvOiB7IG5hbWU6ICdlMmUtdGVzdC1jbGllbnQnLCB2ZXJzaW9uOiAnMS4wLjAnIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH07XG4gICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRpbj8ud3JpdGUoSlNPTi5zdHJpbmdpZnkoaW5pdFJlcXVlc3QpICsgJ1xcbicpO1xuICAgICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgMjAwMCk7XG4gICAgICAgIH0sIDEwMDApO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRlc3QgaW52YWxpZCB0b29sIGNhbGxcbiAgICAgIGNvbnN0IGludmFsaWRUb29sUmVxdWVzdCA9IHtcbiAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgIGlkOiAyLFxuICAgICAgICBtZXRob2Q6ICd0b29scy9jYWxsJyxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgbmFtZTogJ25vbmV4aXN0ZW50LXRvb2wnLFxuICAgICAgICAgIGFyZ3VtZW50czoge30sXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9ICcnO1xuXG4gICAgICAgIGNvbnN0IGRhdGFIYW5kbGVyID0gKGRhdGE6IEJ1ZmZlcikgPT4ge1xuICAgICAgICAgIHJlc3BvbnNlRGF0YSArPSBkYXRhLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZURhdGEuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCd7JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UobGluZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmlkID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICBpZiAobWNwU2VydmVyUHJvY2VzcyAmJiBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dCkge1xuICAgICAgICAgICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dC5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBDb250aW51ZSBwcm9jZXNzaW5nXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vbignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRpbj8ud3JpdGUoSlNPTi5zdHJpbmdpZnkoaW52YWxpZFRvb2xSZXF1ZXN0KSArICdcXG4nKTtcblxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICBpZiAobWNwU2VydmVyUHJvY2VzcyAmJiBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dCkge1xuICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQub2ZmKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdJbnZhbGlkIHRvb2wgY2FsbCB0aW1lb3V0JykpO1xuICAgICAgICB9LCA1MDAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuanNvbnJwYykudG9CZSgnMi4wJyk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuaWQpLnRvQmUoMik7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuZXJyb3IpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuZXJyb3IuY29kZSkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5lcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ1Vua25vd24gdG9vbCcpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9