20266d80111c2ff600bb1d512f65a886
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const child_process_1 = require("child_process");
const timers_1 = require("timers");
const mockN8nServer_1 = require("../mocks/mockN8nServer");
const path = __importStar(require("path"));
// Use process.cwd() + relative path for Jest compatibility
const testDir = path.join(process.cwd(), 'tests', 'e2e');
/**
 * End-to-End tests for MCP protocol compliance
 * Tests the FastMCP server implementation against the MCP specification
 */
(0, globals_1.describe)('MCP Protocol E2E Tests', () => {
    let mockN8nServer;
    let mcpServerProcess;
    const mockServerPort = 3001;
    const mcpServerTimeout = 10000;
    (0, globals_1.beforeAll)(async () => {
        // Start mock n8n server
        mockN8nServer = new mockN8nServer_1.MockN8nServer(mockServerPort);
        await mockN8nServer.start();
        console.log('Mock n8n server started for E2E tests');
    }, 15000);
    (0, globals_1.afterAll)(async () => {
        // Stop mock n8n server
        if (mockN8nServer) {
            await mockN8nServer.stop();
        }
        console.log('Mock n8n server stopped');
    }, 10000);
    (0, globals_1.beforeEach)(() => {
        // Clean up any existing MCP server process
        if (mcpServerProcess) {
            mcpServerProcess.kill('SIGTERM');
            mcpServerProcess = null;
        }
    });
    (0, globals_1.afterEach)(() => {
        // Ensure MCP server process is terminated
        if (mcpServerProcess) {
            mcpServerProcess.kill('SIGTERM');
            mcpServerProcess = null;
        }
    });
    (0, globals_1.describe)('MCP Server Initialization', () => {
        (0, globals_1.it)('should start MCP server successfully with stdio transport', async () => {
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            const startServer = () => {
                return new Promise((resolve, reject) => {
                    mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                        env: {
                            ...process.env,
                            N8N_BASE_URL: mockN8nServer.getUrl(),
                            N8N_API_KEY: 'test-api-key',
                            N8N_MCP_TRANSPORT: 'stdio',
                        },
                        stdio: ['pipe', 'pipe', 'pipe'],
                    });
                    let hasResolved = false;
                    let initTimeout = undefined;
                    const cleanup = () => {
                        if (initTimeout) {
                            (0, timers_1.clearTimeout)(initTimeout);
                        }
                    };
                    mcpServerProcess.stdout?.on('data', data => {
                        const output = data.toString();
                        console.log('MCP Server stdout:', output);
                        // Look for initialization success indicators
                        if (output.includes('Server ready') || output.includes('listening') || !hasResolved) {
                            hasResolved = true;
                            cleanup();
                            resolve();
                        }
                    });
                    mcpServerProcess.stderr?.on('data', data => {
                        const error = data.toString();
                        console.error('MCP Server stderr:', error);
                        if (error.includes('Error') || error.includes('EADDRINUSE')) {
                            cleanup();
                            reject(new Error(`MCP server failed to start: ${error}`));
                        }
                    });
                    mcpServerProcess.on('error', error => {
                        cleanup();
                        reject(new Error(`Failed to spawn MCP server: ${error.message}`));
                    });
                    mcpServerProcess.on('exit', (code, signal) => {
                        if (code !== 0 && code !== null && !hasResolved) {
                            cleanup();
                            reject(new Error(`MCP server exited with code ${code}, signal ${signal}`));
                        }
                    });
                    // Set timeout for server initialization
                    initTimeout = (0, timers_1.setTimeout)(() => {
                        if (!hasResolved) {
                            hasResolved = true;
                            cleanup();
                            resolve(); // Assume success if no explicit errors
                        }
                    }, 5000);
                });
            };
            await (0, globals_1.expect)(startServer()).resolves.not.toThrow();
            (0, globals_1.expect)(mcpServerProcess).toBeDefined();
            (0, globals_1.expect)(mcpServerProcess.pid).toBeGreaterThan(0);
        }, mcpServerTimeout);
        (0, globals_1.it)('should handle MCP initialization protocol', async () => {
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            const testInitialization = () => {
                return new Promise((resolve, reject) => {
                    mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                        env: {
                            ...process.env,
                            N8N_BASE_URL: mockN8nServer.getUrl(),
                            N8N_API_KEY: 'test-api-key',
                            N8N_MCP_TRANSPORT: 'stdio',
                        },
                        stdio: ['pipe', 'pipe', 'pipe'],
                    });
                    let responseData = '';
                    let hasResolved = false;
                    const cleanup = () => {
                        if (!hasResolved) {
                            hasResolved = true;
                        }
                    };
                    mcpServerProcess.stdout?.on('data', data => {
                        responseData += data.toString();
                        // Look for JSON-RPC response
                        try {
                            const lines = responseData.split('\n').filter(line => line.trim());
                            for (const line of lines) {
                                if (line.startsWith('{')) {
                                    const response = JSON.parse(line);
                                    if (response.result && response.result.capabilities) {
                                        cleanup();
                                        resolve(response);
                                        return;
                                    }
                                }
                            }
                        }
                        catch (e) {
                            // Continue processing
                        }
                    });
                    mcpServerProcess.stderr?.on('data', data => {
                        console.error('MCP Server stderr:', data.toString());
                    });
                    mcpServerProcess.on('error', error => {
                        cleanup();
                        reject(error);
                    });
                    // Send MCP initialization request
                    const initRequest = {
                        jsonrpc: '2.0',
                        id: 1,
                        method: 'initialize',
                        params: {
                            protocolVersion: '2024-11-05',
                            capabilities: {
                                tools: {},
                                resources: {},
                            },
                            clientInfo: {
                                name: 'e2e-test-client',
                                version: '1.0.0',
                            },
                        },
                    };
                    (0, timers_1.setTimeout)(() => {
                        if (mcpServerProcess && mcpServerProcess.stdin) {
                            mcpServerProcess.stdin.write(JSON.stringify(initRequest) + '\n');
                        }
                    }, 1000);
                    // Timeout for initialization
                    (0, timers_1.setTimeout)(() => {
                        if (!hasResolved) {
                            cleanup();
                            reject(new Error('MCP initialization timeout'));
                        }
                    }, 8000);
                });
            };
            const response = await testInitialization();
            // Verify MCP protocol compliance
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(1);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.capabilities).toBeDefined();
            (0, globals_1.expect)(response.result.capabilities.tools).toBeDefined();
            (0, globals_1.expect)(response.result.serverInfo).toBeDefined();
            (0, globals_1.expect)(response.result.serverInfo.name).toBe('n8n-mcp-server');
        }, mcpServerTimeout);
    });
    (0, globals_1.describe)('MCP Tools Protocol', () => {
        let initializedServer;
        (0, globals_1.beforeEach)(async () => {
            // Initialize server for tools testing
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            initializedServer = await new Promise((resolve, reject) => {
                mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                    env: {
                        ...process.env,
                        N8N_BASE_URL: mockN8nServer.getUrl(),
                        N8N_API_KEY: 'test-api-key',
                        N8N_MCP_TRANSPORT: 'stdio',
                    },
                    stdio: ['pipe', 'pipe', 'pipe'],
                });
                let responseData = '';
                let isInitialized = false;
                mcpServerProcess.stdout?.on('data', data => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.result && response.result.capabilities && !isInitialized) {
                                    isInitialized = true;
                                    resolve(mcpServerProcess);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                });
                mcpServerProcess.on('error', reject);
                // Send initialization
                (0, timers_1.setTimeout)(() => {
                    const initRequest = {
                        jsonrpc: '2.0',
                        id: 1,
                        method: 'initialize',
                        params: {
                            protocolVersion: '2024-11-05',
                            capabilities: { tools: {}, resources: {} },
                            clientInfo: { name: 'e2e-test-client', version: '1.0.0' },
                        },
                    };
                    mcpServerProcess.stdin?.write(JSON.stringify(initRequest) + '\n');
                }, 1000);
                (0, timers_1.setTimeout)(() => {
                    if (!isInitialized) {
                        reject(new Error('Server initialization timeout'));
                    }
                }, 8000);
            });
        }, mcpServerTimeout);
        (0, globals_1.it)('should list available tools', async () => {
            const listToolsRequest = {
                jsonrpc: '2.0',
                id: 2,
                method: 'tools/list',
                params: {},
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 2) {
                                    mcpServerProcess.stdout?.off('data', dataHandler);
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(listToolsRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    mcpServerProcess.stdout?.off('data', dataHandler);
                    reject(new Error('Tools list timeout'));
                }, 5000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(2);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.tools).toBeDefined();
            (0, globals_1.expect)(Array.isArray(response.result.tools)).toBe(true);
            // Verify essential n8n tools are present
            const tools = response.result.tools;
            const toolNames = tools.map((tool) => tool.name);
            (0, globals_1.expect)(toolNames).toContain('init-n8n');
            (0, globals_1.expect)(toolNames).toContain('list-workflows');
            (0, globals_1.expect)(toolNames).toContain('get-workflow');
            (0, globals_1.expect)(toolNames).toContain('create-workflow');
        });
        (0, globals_1.it)('should execute init-n8n tool successfully', async () => {
            const toolCallRequest = {
                jsonrpc: '2.0',
                id: 3,
                method: 'tools/call',
                params: {
                    name: 'init-n8n',
                    arguments: {
                        baseUrl: mockN8nServer.getUrl(),
                        apiKey: 'test-api-key',
                    },
                },
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 3) {
                                    mcpServerProcess.stdout?.off('data', dataHandler);
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(toolCallRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    mcpServerProcess.stdout?.off('data', dataHandler);
                    reject(new Error('Tool call timeout'));
                }, 8000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(3);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.content).toBeDefined();
            (0, globals_1.expect)(Array.isArray(response.result.content)).toBe(true);
            (0, globals_1.expect)(response.result.content[0].type).toBe('text');
            (0, globals_1.expect)(response.result.content[0].text).toContain('Successfully connected');
        });
        (0, globals_1.it)('should execute list-workflows tool successfully', async () => {
            // First initialize n8n
            const initRequest = {
                jsonrpc: '2.0',
                id: 4,
                method: 'tools/call',
                params: {
                    name: 'init-n8n',
                    arguments: {
                        baseUrl: mockN8nServer.getUrl(),
                        apiKey: 'test-api-key',
                    },
                },
            };
            await new Promise(resolve => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 4) {
                                    mcpServerProcess.stdout?.off('data', dataHandler);
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(initRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    mcpServerProcess.stdout?.off('data', dataHandler);
                    resolve(null);
                }, 5000);
            });
            // Now test list-workflows
            const listWorkflowsRequest = {
                jsonrpc: '2.0',
                id: 5,
                method: 'tools/call',
                params: {
                    name: 'list-workflows',
                    arguments: {
                        limit: 10,
                    },
                },
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 5) {
                                    mcpServerProcess.stdout?.off('data', dataHandler);
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(listWorkflowsRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    mcpServerProcess.stdout?.off('data', dataHandler);
                    reject(new Error('List workflows timeout'));
                }, 8000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(5);
            (0, globals_1.expect)(response.result).toBeDefined();
            (0, globals_1.expect)(response.result.content).toBeDefined();
            (0, globals_1.expect)(Array.isArray(response.result.content)).toBe(true);
            (0, globals_1.expect)(response.result.content[0].type).toBe('text');
            // Verify response contains workflow data
            const responseText = response.result.content[0].text;
            (0, globals_1.expect)(responseText).toContain('workflow(s)');
            (0, globals_1.expect)(responseText).toContain('Test Workflow');
        });
    });
    (0, globals_1.describe)('Error Handling', () => {
        (0, globals_1.it)('should handle invalid tool names gracefully', async () => {
            // Initialize server first
            const serverPath = path.join(testDir, '../../build/index-fastmcp.js');
            mcpServerProcess = (0, child_process_1.spawn)('node', [serverPath], {
                env: {
                    ...process.env,
                    N8N_BASE_URL: mockN8nServer.getUrl(),
                    N8N_API_KEY: 'test-api-key',
                    N8N_MCP_TRANSPORT: 'stdio',
                },
                stdio: ['pipe', 'pipe', 'pipe'],
            });
            // Wait for initialization
            await new Promise(resolve => {
                (0, timers_1.setTimeout)(() => {
                    const initRequest = {
                        jsonrpc: '2.0',
                        id: 1,
                        method: 'initialize',
                        params: {
                            protocolVersion: '2024-11-05',
                            capabilities: { tools: {}, resources: {} },
                            clientInfo: { name: 'e2e-test-client', version: '1.0.0' },
                        },
                    };
                    mcpServerProcess.stdin?.write(JSON.stringify(initRequest) + '\n');
                    (0, timers_1.setTimeout)(resolve, 2000);
                }, 1000);
            });
            // Test invalid tool call
            const invalidToolRequest = {
                jsonrpc: '2.0',
                id: 2,
                method: 'tools/call',
                params: {
                    name: 'nonexistent-tool',
                    arguments: {},
                },
            };
            const response = await new Promise((resolve, reject) => {
                let responseData = '';
                const dataHandler = (data) => {
                    responseData += data.toString();
                    try {
                        const lines = responseData.split('\n').filter(line => line.trim());
                        for (const line of lines) {
                            if (line.startsWith('{')) {
                                const response = JSON.parse(line);
                                if (response.id === 2) {
                                    mcpServerProcess.stdout?.off('data', dataHandler);
                                    resolve(response);
                                    return;
                                }
                            }
                        }
                    }
                    catch (e) {
                        // Continue processing
                    }
                };
                mcpServerProcess.stdout?.on('data', dataHandler);
                mcpServerProcess.stdin?.write(JSON.stringify(invalidToolRequest) + '\n');
                (0, timers_1.setTimeout)(() => {
                    mcpServerProcess.stdout?.off('data', dataHandler);
                    reject(new Error('Invalid tool call timeout'));
                }, 5000);
            });
            (0, globals_1.expect)(response).toBeDefined();
            (0, globals_1.expect)(response.jsonrpc).toBe('2.0');
            (0, globals_1.expect)(response.id).toBe(2);
            (0, globals_1.expect)(response.error).toBeDefined();
            (0, globals_1.expect)(response.error.code).toBeDefined();
            (0, globals_1.expect)(response.error.message).toContain('Unknown tool');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2plcmVteXBhcmtlci9EZXNrdG9wL0NsYXVkZSBDb2RpbmcgUHJvamVjdHMvbjhuLW1jcC1zZXJ2ZXIvdGVzdHMvZTJlL21jcC1wcm90b2NvbC50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQWlHO0FBQ2pHLGlEQUFvRDtBQUNwRCxtQ0FBa0Q7QUFDbEQsMERBQXVEO0FBQ3ZELDJDQUE2QjtBQUU3QiwyREFBMkQ7QUFDM0QsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO0FBRXpEOzs7R0FHRztBQUNILElBQUEsa0JBQVEsRUFBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUU7SUFDdEMsSUFBSSxhQUE0QixDQUFDO0lBQ2pDLElBQUksZ0JBQThCLENBQUM7SUFDbkMsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDO0lBQzVCLE1BQU0sZ0JBQWdCLEdBQUcsS0FBSyxDQUFDO0lBRS9CLElBQUEsbUJBQVMsRUFBQyxLQUFLLElBQUksRUFBRTtRQUNuQix3QkFBd0I7UUFDeEIsYUFBYSxHQUFHLElBQUksNkJBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNsRCxNQUFNLGFBQWEsQ0FBQyxLQUFLLEVBQUUsQ0FBQztRQUU1QixPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxDQUFDLENBQUM7SUFDdkQsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBRVYsSUFBQSxrQkFBUSxFQUFDLEtBQUssSUFBSSxFQUFFO1FBQ2xCLHVCQUF1QjtRQUN2QixJQUFJLGFBQWEsRUFBRSxDQUFDO1lBQ2xCLE1BQU0sYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQzdCLENBQUM7UUFFRCxPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixDQUFDLENBQUM7SUFDekMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBRVYsSUFBQSxv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ZW15cGFya2VyL0Rlc2t0b3AvQ2xhdWRlIENvZGluZyBQcm9qZWN0cy9uOG4tbWNwLXNlcnZlci90ZXN0cy9lMmUvbWNwLXByb3RvY29sLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGJlZm9yZUFsbCwgYWZ0ZXJBbGwsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCwgaXQsIGV4cGVjdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgc3Bhd24sIENoaWxkUHJvY2VzcyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHsgc2V0VGltZW91dCwgY2xlYXJUaW1lb3V0IH0gZnJvbSAndGltZXJzJztcbmltcG9ydCB7IE1vY2tOOG5TZXJ2ZXIgfSBmcm9tICcuLi9tb2Nrcy9tb2NrTjhuU2VydmVyJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5cbi8vIFVzZSBwcm9jZXNzLmN3ZCgpICsgcmVsYXRpdmUgcGF0aCBmb3IgSmVzdCBjb21wYXRpYmlsaXR5XG5jb25zdCB0ZXN0RGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICd0ZXN0cycsICdlMmUnKTtcblxuLyoqXG4gKiBFbmQtdG8tRW5kIHRlc3RzIGZvciBNQ1AgcHJvdG9jb2wgY29tcGxpYW5jZVxuICogVGVzdHMgdGhlIEZhc3RNQ1Agc2VydmVyIGltcGxlbWVudGF0aW9uIGFnYWluc3QgdGhlIE1DUCBzcGVjaWZpY2F0aW9uXG4gKi9cbmRlc2NyaWJlKCdNQ1AgUHJvdG9jb2wgRTJFIFRlc3RzJywgKCkgPT4ge1xuICBsZXQgbW9ja044blNlcnZlcjogTW9ja044blNlcnZlcjtcbiAgbGV0IG1jcFNlcnZlclByb2Nlc3M6IENoaWxkUHJvY2VzcztcbiAgY29uc3QgbW9ja1NlcnZlclBvcnQgPSAzMDAxO1xuICBjb25zdCBtY3BTZXJ2ZXJUaW1lb3V0ID0gMTAwMDA7XG5cbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBTdGFydCBtb2NrIG44biBzZXJ2ZXJcbiAgICBtb2NrTjhuU2VydmVyID0gbmV3IE1vY2tOOG5TZXJ2ZXIobW9ja1NlcnZlclBvcnQpO1xuICAgIGF3YWl0IG1vY2tOOG5TZXJ2ZXIuc3RhcnQoKTtcblxuICAgIGNvbnNvbGUubG9nKCdNb2NrIG44biBzZXJ2ZXIgc3RhcnRlZCBmb3IgRTJFIHRlc3RzJyk7XG4gIH0sIDE1MDAwKTtcblxuICBhZnRlckFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gU3RvcCBtb2NrIG44biBzZXJ2ZXJcbiAgICBpZiAobW9ja044blNlcnZlcikge1xuICAgICAgYXdhaXQgbW9ja044blNlcnZlci5zdG9wKCk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ01vY2sgbjhuIHNlcnZlciBzdG9wcGVkJyk7XG4gIH0sIDEwMDAwKTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBDbGVhbiB1cCBhbnkgZXhpc3RpbmcgTUNQIHNlcnZlciBwcm9jZXNzXG4gICAgaWYgKG1jcFNlcnZlclByb2Nlc3MpIHtcbiAgICAgIG1jcFNlcnZlclByb2Nlc3Mua2lsbCgnU0lHVEVSTScpO1xuICAgICAgbWNwU2VydmVyUHJvY2VzcyA9IG51bGwgYXMgYW55O1xuICAgIH1cbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICAvLyBFbnN1cmUgTUNQIHNlcnZlciBwcm9jZXNzIGlzIHRlcm1pbmF0ZWRcbiAgICBpZiAobWNwU2VydmVyUHJvY2Vzcykge1xuICAgICAgbWNwU2VydmVyUHJvY2Vzcy5raWxsKCdTSUdURVJNJyk7XG4gICAgICBtY3BTZXJ2ZXJQcm9jZXNzID0gbnVsbCBhcyBhbnk7XG4gICAgfVxuICB9KTtcblxuICBkZXNjcmliZSgnTUNQIFNlcnZlciBJbml0aWFsaXphdGlvbicsICgpID0+IHtcbiAgICBpdChcbiAgICAgICdzaG91bGQgc3RhcnQgTUNQIHNlcnZlciBzdWNjZXNzZnVsbHkgd2l0aCBzdGRpbyB0cmFuc3BvcnQnLFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBzZXJ2ZXJQYXRoID0gcGF0aC5qb2luKHRlc3REaXIsICcuLi8uLi9idWlsZC9pbmRleC1mYXN0bWNwLmpzJyk7XG5cbiAgICAgICAgY29uc3Qgc3RhcnRTZXJ2ZXIgPSAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3MgPSBzcGF3bignbm9kZScsIFtzZXJ2ZXJQYXRoXSwge1xuICAgICAgICAgICAgICBlbnY6IHtcbiAgICAgICAgICAgICAgICAuLi5wcm9jZXNzLmVudixcbiAgICAgICAgICAgICAgICBOOE5fQkFTRV9VUkw6IG1vY2tOOG5TZXJ2ZXIuZ2V0VXJsKCksXG4gICAgICAgICAgICAgICAgTjhOX0FQSV9LRVk6ICd0ZXN0LWFwaS1rZXknLFxuICAgICAgICAgICAgICAgIE44Tl9NQ1BfVFJBTlNQT1JUOiAnc3RkaW8nLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBzdGRpbzogWydwaXBlJywgJ3BpcGUnLCAncGlwZSddLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGxldCBoYXNSZXNvbHZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IGluaXRUaW1lb3V0OiBSZXR1cm5UeXBlPHR5cGVvZiBzZXRUaW1lb3V0PiB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgY29uc3QgY2xlYW51cCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGluaXRUaW1lb3V0KSB7XG4gICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGluaXRUaW1lb3V0KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9uKCdkYXRhJywgZGF0YSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IG91dHB1dCA9IGRhdGEudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01DUCBTZXJ2ZXIgc3Rkb3V0OicsIG91dHB1dCk7XG5cbiAgICAgICAgICAgICAgLy8gTG9vayBmb3IgaW5pdGlhbGl6YXRpb24gc3VjY2VzcyBpbmRpY2F0b3JzXG4gICAgICAgICAgICAgIGlmIChvdXRwdXQuaW5jbHVkZXMoJ1NlcnZlciByZWFkeScpIHx8IG91dHB1dC5pbmNsdWRlcygnbGlzdGVuaW5nJykgfHwgIWhhc1Jlc29sdmVkKSB7XG4gICAgICAgICAgICAgICAgaGFzUmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGVycj8ub24oJ2RhdGEnLCBkYXRhID0+IHtcbiAgICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBkYXRhLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ01DUCBTZXJ2ZXIgc3RkZXJyOicsIGVycm9yKTtcblxuICAgICAgICAgICAgICBpZiAoZXJyb3IuaW5jbHVkZXMoJ0Vycm9yJykgfHwgZXJyb3IuaW5jbHVkZXMoJ0VBRERSSU5VU0UnKSkge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBNQ1Agc2VydmVyIGZhaWxlZCB0byBzdGFydDogJHtlcnJvcn1gKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLm9uKCdlcnJvcicsIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBGYWlsZWQgdG8gc3Bhd24gTUNQIHNlcnZlcjogJHtlcnJvci5tZXNzYWdlfWApKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLm9uKCdleGl0JywgKGNvZGUsIHNpZ25hbCkgPT4ge1xuICAgICAgICAgICAgICBpZiAoY29kZSAhPT0gMCAmJiBjb2RlICE9PSBudWxsICYmICFoYXNSZXNvbHZlZCkge1xuICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKGBNQ1Agc2VydmVyIGV4aXRlZCB3aXRoIGNvZGUgJHtjb2RlfSwgc2lnbmFsICR7c2lnbmFsfWApKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFNldCB0aW1lb3V0IGZvciBzZXJ2ZXIgaW5pdGlhbGl6YXRpb25cbiAgICAgICAgICAgIGluaXRUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICghaGFzUmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICBoYXNSZXNvbHZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTsgLy8gQXNzdW1lIHN1Y2Nlc3MgaWYgbm8gZXhwbGljaXQgZXJyb3JzXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDUwMDApO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGF3YWl0IGV4cGVjdChzdGFydFNlcnZlcigpKS5yZXNvbHZlcy5ub3QudG9UaHJvdygpO1xuICAgICAgICBleHBlY3QobWNwU2VydmVyUHJvY2VzcykudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KG1jcFNlcnZlclByb2Nlc3MucGlkKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICB9LFxuICAgICAgbWNwU2VydmVyVGltZW91dFxuICAgICk7XG5cbiAgICBpdChcbiAgICAgICdzaG91bGQgaGFuZGxlIE1DUCBpbml0aWFsaXphdGlvbiBwcm90b2NvbCcsXG4gICAgICBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlcnZlclBhdGggPSBwYXRoLmpvaW4odGVzdERpciwgJy4uLy4uL2J1aWxkL2luZGV4LWZhc3RtY3AuanMnKTtcblxuICAgICAgICBjb25zdCB0ZXN0SW5pdGlhbGl6YXRpb24gPSAoKTogUHJvbWlzZTxhbnk+ID0+IHtcbiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgbWNwU2VydmVyUHJvY2VzcyA9IHNwYXduKCdub2RlJywgW3NlcnZlclBhdGhdLCB7XG4gICAgICAgICAgICAgIGVudjoge1xuICAgICAgICAgICAgICAgIC4uLnByb2Nlc3MuZW52LFxuICAgICAgICAgICAgICAgIE44Tl9CQVNFX1VSTDogbW9ja044blNlcnZlci5nZXRVcmwoKSxcbiAgICAgICAgICAgICAgICBOOE5fQVBJX0tFWTogJ3Rlc3QtYXBpLWtleScsXG4gICAgICAgICAgICAgICAgTjhOX01DUF9UUkFOU1BPUlQ6ICdzdGRpbycsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHN0ZGlvOiBbJ3BpcGUnLCAncGlwZScsICdwaXBlJ10sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9ICcnO1xuICAgICAgICAgICAgbGV0IGhhc1Jlc29sdmVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGNvbnN0IGNsZWFudXAgPSAoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICghaGFzUmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICBoYXNSZXNvbHZlZCA9IHRydWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vbignZGF0YScsIGRhdGEgPT4ge1xuICAgICAgICAgICAgICByZXNwb25zZURhdGEgKz0gZGF0YS50b1N0cmluZygpO1xuXG4gICAgICAgICAgICAgIC8vIExvb2sgZm9yIEpTT04tUlBDIHJlc3BvbnNlXG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZURhdGEuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ3snKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UobGluZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQgJiYgcmVzcG9uc2UucmVzdWx0LmNhcGFiaWxpdGllcykge1xuICAgICAgICAgICAgICAgICAgICAgIGNsZWFudXAoKTtcbiAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBDb250aW51ZSBwcm9jZXNzaW5nXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGVycj8ub24oJ2RhdGEnLCBkYXRhID0+IHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTUNQIFNlcnZlciBzdGRlcnI6JywgZGF0YS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLm9uKCdlcnJvcicsIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFNlbmQgTUNQIGluaXRpYWxpemF0aW9uIHJlcXVlc3RcbiAgICAgICAgICAgIGNvbnN0IGluaXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICAgICAgaWQ6IDEsXG4gICAgICAgICAgICAgIG1ldGhvZDogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgICBwcm90b2NvbFZlcnNpb246ICcyMDI0LTExLTA1JyxcbiAgICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIHRvb2xzOiB7fSxcbiAgICAgICAgICAgICAgICAgIHJlc291cmNlczoge30sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBjbGllbnRJbmZvOiB7XG4gICAgICAgICAgICAgICAgICBuYW1lOiAnZTJlLXRlc3QtY2xpZW50JyxcbiAgICAgICAgICAgICAgICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBpZiAobWNwU2VydmVyUHJvY2VzcyAmJiBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGluKSB7XG4gICAgICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRpbi53cml0ZShKU09OLnN0cmluZ2lmeShpbml0UmVxdWVzdCkgKyAnXFxuJyk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDEwMDApO1xuXG4gICAgICAgICAgICAvLyBUaW1lb3V0IGZvciBpbml0aWFsaXphdGlvblxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGlmICghaGFzUmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICBjbGVhbnVwKCk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignTUNQIGluaXRpYWxpemF0aW9uIHRpbWVvdXQnKSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sIDgwMDApO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdEluaXRpYWxpemF0aW9uKCk7XG5cbiAgICAgICAgLy8gVmVyaWZ5IE1DUCBwcm90b2NvbCBjb21wbGlhbmNlXG4gICAgICAgIGV4cGVjdChyZXNwb25zZSkudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmpzb25ycGMpLnRvQmUoJzIuMCcpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuaWQpLnRvQmUoMSk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5yZXN1bHQpLnRvQmVEZWZpbmVkKCk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5yZXN1bHQuY2FwYWJpbGl0aWVzKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UucmVzdWx0LmNhcGFiaWxpdGllcy50b29scykudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnJlc3VsdC5zZXJ2ZXJJbmZvKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UucmVzdWx0LnNlcnZlckluZm8ubmFtZSkudG9CZSgnbjhuLW1jcC1zZXJ2ZXInKTtcbiAgICAgIH0sXG4gICAgICBtY3BTZXJ2ZXJUaW1lb3V0XG4gICAgKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ01DUCBUb29scyBQcm90b2NvbCcsICgpID0+IHtcbiAgICBsZXQgaW5pdGlhbGl6ZWRTZXJ2ZXI6IGFueTtcblxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gSW5pdGlhbGl6ZSBzZXJ2ZXIgZm9yIHRvb2xzIHRlc3RpbmdcbiAgICAgIGNvbnN0IHNlcnZlclBhdGggPSBwYXRoLmpvaW4odGVzdERpciwgJy4uLy4uL2J1aWxkL2luZGV4LWZhc3RtY3AuanMnKTtcblxuICAgICAgaW5pdGlhbGl6ZWRTZXJ2ZXIgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3MgPSBzcGF3bignbm9kZScsIFtzZXJ2ZXJQYXRoXSwge1xuICAgICAgICAgIGVudjoge1xuICAgICAgICAgICAgLi4ucHJvY2Vzcy5lbnYsXG4gICAgICAgICAgICBOOE5fQkFTRV9VUkw6IG1vY2tOOG5TZXJ2ZXIuZ2V0VXJsKCksXG4gICAgICAgICAgICBOOE5fQVBJX0tFWTogJ3Rlc3QtYXBpLWtleScsXG4gICAgICAgICAgICBOOE5fTUNQX1RSQU5TUE9SVDogJ3N0ZGlvJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHN0ZGlvOiBbJ3BpcGUnLCAncGlwZScsICdwaXBlJ10sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCByZXNwb25zZURhdGEgPSAnJztcbiAgICAgICAgbGV0IGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcblxuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dD8ub24oJ2RhdGEnLCBkYXRhID0+IHtcbiAgICAgICAgICByZXNwb25zZURhdGEgKz0gZGF0YS50b1N0cmluZygpO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2VEYXRhLnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgneycpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKGxpbmUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXN1bHQgJiYgcmVzcG9uc2UucmVzdWx0LmNhcGFiaWxpdGllcyAmJiAhaXNJbml0aWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICByZXNvbHZlKG1jcFNlcnZlclByb2Nlc3MpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIHByb2Nlc3NpbmdcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Mub24oJ2Vycm9yJywgcmVqZWN0KTtcblxuICAgICAgICAvLyBTZW5kIGluaXRpYWxpemF0aW9uXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IGluaXRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgICAgICBpZDogMSxcbiAgICAgICAgICAgIG1ldGhvZDogJ2luaXRpYWxpemUnLFxuICAgICAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgICAgIHByb3RvY29sVmVyc2lvbjogJzIwMjQtMTEtMDUnLFxuICAgICAgICAgICAgICBjYXBhYmlsaXRpZXM6IHsgdG9vbHM6IHt9LCByZXNvdXJjZXM6IHt9IH0sXG4gICAgICAgICAgICAgIGNsaWVudEluZm86IHsgbmFtZTogJ2UyZS10ZXN0LWNsaWVudCcsIHZlcnNpb246ICcxLjAuMCcgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfTtcbiAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGluPy53cml0ZShKU09OLnN0cmluZ2lmeShpbml0UmVxdWVzdCkgKyAnXFxuJyk7XG4gICAgICAgIH0sIDEwMDApO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGlmICghaXNJbml0aWFsaXplZCkge1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignU2VydmVyIGluaXRpYWxpemF0aW9uIHRpbWVvdXQnKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCA4MDAwKTtcbiAgICAgIH0pO1xuICAgIH0sIG1jcFNlcnZlclRpbWVvdXQpO1xuXG4gICAgaXQoJ3Nob3VsZCBsaXN0IGF2YWlsYWJsZSB0b29scycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGxpc3RUb29sc1JlcXVlc3QgPSB7XG4gICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICBpZDogMixcbiAgICAgICAgbWV0aG9kOiAndG9vbHMvbGlzdCcsXG4gICAgICAgIHBhcmFtczoge30sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9ICcnO1xuXG4gICAgICAgIGNvbnN0IGRhdGFIYW5kbGVyID0gKGRhdGE6IEJ1ZmZlcikgPT4ge1xuICAgICAgICAgIHJlc3BvbnNlRGF0YSArPSBkYXRhLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZURhdGEuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCd7JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UobGluZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmlkID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dD8ub2ZmKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gQ29udGludWUgcHJvY2Vzc2luZ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dD8ub24oJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3RkaW4/LndyaXRlKEpTT04uc3RyaW5naWZ5KGxpc3RUb29sc1JlcXVlc3QpICsgJ1xcbicpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignVG9vbHMgbGlzdCB0aW1lb3V0JykpO1xuICAgICAgICB9LCA1MDAwKTtcbiAgICAgIH0pO1xuXG4gICAgICBleHBlY3QocmVzcG9uc2UpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuanNvbnJwYykudG9CZSgnMi4wJyk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuaWQpLnRvQmUoMik7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0KS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC50b29scykudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC50b29scykpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBlc3NlbnRpYWwgbjhuIHRvb2xzIGFyZSBwcmVzZW50XG4gICAgICBjb25zdCB0b29scyA9IChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC50b29scztcbiAgICAgIGNvbnN0IHRvb2xOYW1lcyA9IHRvb2xzLm1hcCgodG9vbDogYW55KSA9PiB0b29sLm5hbWUpO1xuXG4gICAgICBleHBlY3QodG9vbE5hbWVzKS50b0NvbnRhaW4oJ2luaXQtbjhuJyk7XG4gICAgICBleHBlY3QodG9vbE5hbWVzKS50b0NvbnRhaW4oJ2xpc3Qtd29ya2Zsb3dzJyk7XG4gICAgICBleHBlY3QodG9vbE5hbWVzKS50b0NvbnRhaW4oJ2dldC13b3JrZmxvdycpO1xuICAgICAgZXhwZWN0KHRvb2xOYW1lcykudG9Db250YWluKCdjcmVhdGUtd29ya2Zsb3cnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZXhlY3V0ZSBpbml0LW44biB0b29sIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRvb2xDYWxsUmVxdWVzdCA9IHtcbiAgICAgICAganNvbnJwYzogJzIuMCcsXG4gICAgICAgIGlkOiAzLFxuICAgICAgICBtZXRob2Q6ICd0b29scy9jYWxsJyxcbiAgICAgICAgcGFyYW1zOiB7XG4gICAgICAgICAgbmFtZTogJ2luaXQtbjhuJyxcbiAgICAgICAgICBhcmd1bWVudHM6IHtcbiAgICAgICAgICAgIGJhc2VVcmw6IG1vY2tOOG5TZXJ2ZXIuZ2V0VXJsKCksXG4gICAgICAgICAgICBhcGlLZXk6ICd0ZXN0LWFwaS1rZXknLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgbGV0IHJlc3BvbnNlRGF0YSA9ICcnO1xuXG4gICAgICAgIGNvbnN0IGRhdGFIYW5kbGVyID0gKGRhdGE6IEJ1ZmZlcikgPT4ge1xuICAgICAgICAgIHJlc3BvbnNlRGF0YSArPSBkYXRhLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZURhdGEuc3BsaXQoJ1xcbicpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCd7JykpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IEpTT04ucGFyc2UobGluZSk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmlkID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dD8ub2ZmKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgLy8gQ29udGludWUgcHJvY2Vzc2luZ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZG91dD8ub24oJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3RkaW4/LndyaXRlKEpTT04uc3RyaW5naWZ5KHRvb2xDYWxsUmVxdWVzdCkgKyAnXFxuJyk7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9mZignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdUb29sIGNhbGwgdGltZW91dCcpKTtcbiAgICAgICAgfSwgODAwMCk7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmpzb25ycGMpLnRvQmUoJzIuMCcpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmlkKS50b0JlKDMpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5yZXN1bHQuY29udGVudCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC5jb250ZW50KSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5yZXN1bHQuY29udGVudFswXS50eXBlKS50b0JlKCd0ZXh0Jyk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkucmVzdWx0LmNvbnRlbnRbMF0udGV4dCkudG9Db250YWluKCdTdWNjZXNzZnVsbHkgY29ubmVjdGVkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGV4ZWN1dGUgbGlzdC13b3JrZmxvd3MgdG9vbCBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBGaXJzdCBpbml0aWFsaXplIG44blxuICAgICAgY29uc3QgaW5pdFJlcXVlc3QgPSB7XG4gICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICBpZDogNCxcbiAgICAgICAgbWV0aG9kOiAndG9vbHMvY2FsbCcsXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIG5hbWU6ICdpbml0LW44bicsXG4gICAgICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgICAgICBiYXNlVXJsOiBtb2NrTjhuU2VydmVyLmdldFVybCgpLFxuICAgICAgICAgICAgYXBpS2V5OiAndGVzdC1hcGkta2V5JyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG4gICAgICAgIGxldCByZXNwb25zZURhdGEgPSAnJztcblxuICAgICAgICBjb25zdCBkYXRhSGFuZGxlciA9IChkYXRhOiBCdWZmZXIpID0+IHtcbiAgICAgICAgICByZXNwb25zZURhdGEgKz0gZGF0YS50b1N0cmluZygpO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2VEYXRhLnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgneycpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKGxpbmUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5pZCA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9mZignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIHByb2Nlc3NpbmdcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9uKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGluPy53cml0ZShKU09OLnN0cmluZ2lmeShpbml0UmVxdWVzdCkgKyAnXFxuJyk7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9mZignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgICByZXNvbHZlKG51bGwpO1xuICAgICAgICB9LCA1MDAwKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBOb3cgdGVzdCBsaXN0LXdvcmtmbG93c1xuICAgICAgY29uc3QgbGlzdFdvcmtmbG93c1JlcXVlc3QgPSB7XG4gICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICBpZDogNSxcbiAgICAgICAgbWV0aG9kOiAndG9vbHMvY2FsbCcsXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIG5hbWU6ICdsaXN0LXdvcmtmbG93cycsXG4gICAgICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgICAgICBsaW1pdDogMTAsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBsZXQgcmVzcG9uc2VEYXRhID0gJyc7XG5cbiAgICAgICAgY29uc3QgZGF0YUhhbmRsZXIgPSAoZGF0YTogQnVmZmVyKSA9PiB7XG4gICAgICAgICAgcmVzcG9uc2VEYXRhICs9IGRhdGEudG9TdHJpbmcoKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lcyA9IHJlc3BvbnNlRGF0YS5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ3snKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gSlNPTi5wYXJzZShsaW5lKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuaWQgPT09IDUpIHtcbiAgICAgICAgICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBDb250aW51ZSBwcm9jZXNzaW5nXG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vbignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRpbj8ud3JpdGUoSlNPTi5zdHJpbmdpZnkobGlzdFdvcmtmbG93c1JlcXVlc3QpICsgJ1xcbicpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignTGlzdCB3b3JrZmxvd3MgdGltZW91dCcpKTtcbiAgICAgICAgfSwgODAwMCk7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmpzb25ycGMpLnRvQmUoJzIuMCcpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmlkKS50b0JlKDUpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5yZXN1bHQuY29udGVudCkudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KChyZXNwb25zZSBhcyBhbnkpLnJlc3VsdC5jb250ZW50KSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdCgocmVzcG9uc2UgYXMgYW55KS5yZXN1bHQuY29udGVudFswXS50eXBlKS50b0JlKCd0ZXh0Jyk7XG5cbiAgICAgIC8vIFZlcmlmeSByZXNwb25zZSBjb250YWlucyB3b3JrZmxvdyBkYXRhXG4gICAgICBjb25zdCByZXNwb25zZVRleHQgPSAocmVzcG9uc2UgYXMgYW55KS5yZXN1bHQuY29udGVudFswXS50ZXh0O1xuICAgICAgZXhwZWN0KHJlc3BvbnNlVGV4dCkudG9Db250YWluKCd3b3JrZmxvdyhzKScpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlVGV4dCkudG9Db250YWluKCdUZXN0IFdvcmtmbG93Jyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFcnJvciBIYW5kbGluZycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHRvb2wgbmFtZXMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEluaXRpYWxpemUgc2VydmVyIGZpcnN0XG4gICAgICBjb25zdCBzZXJ2ZXJQYXRoID0gcGF0aC5qb2luKHRlc3REaXIsICcuLi8uLi9idWlsZC9pbmRleC1mYXN0bWNwLmpzJyk7XG5cbiAgICAgIG1jcFNlcnZlclByb2Nlc3MgPSBzcGF3bignbm9kZScsIFtzZXJ2ZXJQYXRoXSwge1xuICAgICAgICBlbnY6IHtcbiAgICAgICAgICAuLi5wcm9jZXNzLmVudixcbiAgICAgICAgICBOOE5fQkFTRV9VUkw6IG1vY2tOOG5TZXJ2ZXIuZ2V0VXJsKCksXG4gICAgICAgICAgTjhOX0FQSV9LRVk6ICd0ZXN0LWFwaS1rZXknLFxuICAgICAgICAgIE44Tl9NQ1BfVFJBTlNQT1JUOiAnc3RkaW8nLFxuICAgICAgICB9LFxuICAgICAgICBzdGRpbzogWydwaXBlJywgJ3BpcGUnLCAncGlwZSddLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIGluaXRpYWxpemF0aW9uXG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgY29uc3QgaW5pdFJlcXVlc3QgPSB7XG4gICAgICAgICAgICBqc29ucnBjOiAnMi4wJyxcbiAgICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgICAgbWV0aG9kOiAnaW5pdGlhbGl6ZScsXG4gICAgICAgICAgICBwYXJhbXM6IHtcbiAgICAgICAgICAgICAgcHJvdG9jb2xWZXJzaW9uOiAnMjAyNC0xMS0wNScsXG4gICAgICAgICAgICAgIGNhcGFiaWxpdGllczogeyB0b29sczoge30sIHJlc291cmNlczoge30gfSxcbiAgICAgICAgICAgICAgY2xpZW50SW5mbzogeyBuYW1lOiAnZTJlLXRlc3QtY2xpZW50JywgdmVyc2lvbjogJzEuMC4wJyB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3RkaW4/LndyaXRlKEpTT04uc3RyaW5naWZ5KGluaXRSZXF1ZXN0KSArICdcXG4nKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMDApO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUZXN0IGludmFsaWQgdG9vbCBjYWxsXG4gICAgICBjb25zdCBpbnZhbGlkVG9vbFJlcXVlc3QgPSB7XG4gICAgICAgIGpzb25ycGM6ICcyLjAnLFxuICAgICAgICBpZDogMixcbiAgICAgICAgbWV0aG9kOiAndG9vbHMvY2FsbCcsXG4gICAgICAgIHBhcmFtczoge1xuICAgICAgICAgIG5hbWU6ICdub25leGlzdGVudC10b29sJyxcbiAgICAgICAgICBhcmd1bWVudHM6IHt9LFxuICAgICAgICB9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIGxldCByZXNwb25zZURhdGEgPSAnJztcblxuICAgICAgICBjb25zdCBkYXRhSGFuZGxlciA9IChkYXRhOiBCdWZmZXIpID0+IHtcbiAgICAgICAgICByZXNwb25zZURhdGEgKz0gZGF0YS50b1N0cmluZygpO1xuXG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gcmVzcG9uc2VEYXRhLnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgneycpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBKU09OLnBhcnNlKGxpbmUpO1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5pZCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9mZignZGF0YScsIGRhdGFIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIENvbnRpbnVlIHByb2Nlc3NpbmdcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgbWNwU2VydmVyUHJvY2Vzcy5zdGRvdXQ/Lm9uKCdkYXRhJywgZGF0YUhhbmRsZXIpO1xuICAgICAgICBtY3BTZXJ2ZXJQcm9jZXNzLnN0ZGluPy53cml0ZShKU09OLnN0cmluZ2lmeShpbnZhbGlkVG9vbFJlcXVlc3QpICsgJ1xcbicpO1xuXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIG1jcFNlcnZlclByb2Nlc3Muc3Rkb3V0Py5vZmYoJ2RhdGEnLCBkYXRhSGFuZGxlcik7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignSW52YWxpZCB0b29sIGNhbGwgdGltZW91dCcpKTtcbiAgICAgICAgfSwgNTAwMCk7XG4gICAgICB9KTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmpzb25ycGMpLnRvQmUoJzIuMCcpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmlkKS50b0JlKDIpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmVycm9yKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KChyZXNwb25zZSBhcyBhbnkpLmVycm9yLmNvZGUpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QoKHJlc3BvbnNlIGFzIGFueSkuZXJyb3IubWVzc2FnZSkudG9Db250YWluKCdVbmtub3duIHRvb2wnKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==