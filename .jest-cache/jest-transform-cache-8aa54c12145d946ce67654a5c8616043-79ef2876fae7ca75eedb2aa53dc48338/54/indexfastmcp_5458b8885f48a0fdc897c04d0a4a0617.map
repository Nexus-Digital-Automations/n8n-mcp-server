{"file":"/Users/jeremyparker/Desktop/Claude Coding Projects/n8n-mcp-server/src/index-fastmcp.ts","mappings":"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","names":[],"sources":["/Users/jeremyparker/Desktop/Claude Coding Projects/n8n-mcp-server/src/index-fastmcp.ts"],"sourcesContent":["\n\nimport { FastMCP } from 'fastmcp';\nimport { z } from 'zod';\nimport { N8nClient } from './client/n8nClient.js';\nimport { createWorkflowTools } from './tools/workflow.js';\nimport { createProjectTools } from './tools/projects.js';\nimport { createUserTools } from './tools/users.js';\nimport { createVariableTools } from './tools/variables.js';\nimport { createExecutionTools } from './tools/executions.js';\nimport { createTagTools } from './tools/tags.js';\nimport { createCredentialTools } from './tools/credentials.js';\nimport { createAuditTools } from './tools/audit.js';\nimport { createAIConfigTools } from './tools/ai-config.js';\nimport { createAITestingTools } from './tools/ai-testing.js';\nimport { createAIModelsTools } from './tools/ai-models.js';\nimport { createMonitoringTools } from './tools/monitoring.js';\nimport { createAnalyticsTools } from './tools/analytics.js';\nimport { createTemplateTools } from './tools/templates.js';\nimport {\n  detectTransportConfig,\n  validateTransportConfig,\n  getServerUrl,\n} from './transport/transportConfig.js';\nimport { createSSETransport, SSEUtils } from './transport/sseTransport.js';\n\n// Global client instance\nlet n8nClient: N8nClient | null = null;\n\n// FastMCP server instance\nconst server = new FastMCP({\n  name: 'n8n-mcp-server',\n  version: '2.0.0',\n  instructions: `\nThis server provides comprehensive access to n8n workflows, executions, users, projects, credentials, and AI capabilities through the Model Context Protocol.\n\nKey Features:\n- Complete workflow management (create, read, update, delete, activate/deactivate)\n- User and project management (Enterprise features)\n- Execution monitoring and management\n- Credential and variable management\n- Tag system for organization\n- Audit and security reporting\n- AI-centric features for AI node configuration and testing\n- AI model management and recommendations\n- AI prompt validation and testing tools\n- Advanced monitoring and alerting system\n- Workflow performance tracking and health checks\n- Error notification and alert rule management\n- Workflow intelligence and complexity analysis\n- Performance bottleneck identification and optimization suggestions\n- Workflow comparison and best practice identification\n- Template and pattern management with curated library\n- Workflow template search, import/export, and pattern analysis\n\nGetting Started:\n1. Initialize connection: Use 'init-n8n' with your n8n instance URL and API key\n2. Explore workflows: Use 'list-workflows' to see available workflows\n3. Manage workflows: Create, update, activate/deactivate workflows as needed\n4. Explore AI features: Use 'list-ai-models' to see available AI models and 'list-ai-nodes' to find AI nodes in workflows\n5. Monitor system health: Use 'get-monitoring-dashboard' for real-time system overview and 'check-workflow-health' for detailed analysis\n\nThe server supports both Community and Enterprise n8n features. Enterprise features (projects, variables) will return appropriate errors if not available in your n8n instance.\n\nAll operations include proper error handling and user-friendly messages. Long-running operations report progress when possible.\n  `.trim(),\n});\n\n// Function to get the global client instance\nconst getClient = () => n8nClient;\n\n// Helper function to set the global client\nconst setClient = (client: N8nClient) => {\n  n8nClient = client;\n};\n\n// Register all tools using the create*Tools helpers\ncreateWorkflowTools(getClient, server);\ncreateProjectTools(getClient, server);\ncreateUserTools(getClient, server);\ncreateVariableTools(getClient, server);\ncreateExecutionTools(getClient, server);\ncreateTagTools(getClient, server);\ncreateCredentialTools(getClient, server);\ncreateAuditTools(getClient, server);\n\n// Register AI-centric tools (Phase 3)\ncreateAIConfigTools(getClient, server);\ncreateAITestingTools(getClient, server);\ncreateAIModelsTools(getClient, server);\n\n// Register advanced monitoring tools (Phase 3)\ncreateMonitoringTools(getClient, server);\n\n// Register workflow analytics and intelligence tools (Phase 3)\ncreateAnalyticsTools(getClient, server);\n\n// Register template and pattern management tools (Phase 3)\ncreateTemplateTools(getClient, server);\n\n// Override the init-n8n tool to properly set the global client\nserver.addTool({\n  name: 'init-n8n',\n  description: 'Initialize connection to n8n instance with base URL and API key',\n  parameters: z.object({\n    baseUrl: z.string().url('Must be a valid URL'),\n    apiKey: z.string().min(1, 'API key is required'),\n  }),\n  annotations: {\n    title: 'Initialize n8n Connection',\n    readOnlyHint: false,\n    destructiveHint: false,\n    idempotentHint: true,\n    openWorldHint: true,\n  },\n  execute: async (args: any) => {\n    try {\n      // Create and set the global client\n      const client = new N8nClient(args.baseUrl, args.apiKey);\n\n      // Test the connection\n      await client.getWorkflows({ limit: 1 });\n\n      // Set the global client\n      setClient(client);\n\n      return `âœ… Successfully connected to n8n instance at ${args.baseUrl}`;\n    } catch (error) {\n      if (error instanceof Error) {\n        throw new Error(`Failed to connect to n8n: ${error.message}`);\n      }\n      throw new Error('Failed to connect to n8n with unknown error');\n    }\n  },\n});\n\n// Add a simple status check tool\nserver.addTool({\n  name: 'status',\n  description: 'Check the current connection status to n8n',\n  parameters: z.object({}),\n  annotations: {\n    title: 'Check n8n Connection Status',\n    readOnlyHint: true,\n    destructiveHint: false,\n    idempotentHint: true,\n    openWorldHint: true,\n  },\n  execute: async () => {\n    if (!n8nClient) {\n      return \"âŒ Not connected to n8n. Please run 'init-n8n' first.\";\n    }\n\n    try {\n      // Test the connection\n      await n8nClient.getWorkflows({ limit: 1 });\n      return 'âœ… Connected to n8n and ready to use.';\n    } catch (error) {\n      return `âš ï¸ Connected but unable to communicate with n8n: ${error instanceof Error ? error.message : String(error)}`;\n    }\n  },\n});\n\n// Configure and start the server with appropriate transport\nasync function startServer() {\n  try {\n    // Detect transport configuration\n    const transportConfig = detectTransportConfig();\n    const validatedConfig = validateTransportConfig(transportConfig);\n\n    console.log(`ðŸš€ Starting n8n MCP Server...`);\n    console.log(`ðŸ“¡ Transport type: ${validatedConfig.type}`);\n\n    if (validatedConfig.type === 'sse') {\n      // Validate SSE configuration\n      if (!SSEUtils.validateConfig(validatedConfig)) {\n        console.error('âŒ Invalid SSE configuration');\n        process.exit(1);\n      }\n\n      // Create and start SSE transport\n      const sseTransport = createSSETransport(server, validatedConfig);\n      await sseTransport.start();\n\n      // Log connection URL\n      const serverUrl = getServerUrl(validatedConfig);\n      if (serverUrl) {\n        console.log(`ðŸŒ Server URL: ${serverUrl}`);\n      }\n    } else {\n      // Start with stdio transport (default)\n      await server.start({\n        transportType: 'stdio',\n      });\n      console.log('ðŸ“Ÿ Server started with stdio transport');\n    }\n\n    console.log('âœ… n8n MCP Server is ready!');\n  } catch (error) {\n    console.error('âŒ Failed to start server:', error);\n    process.exit(1);\n  }\n}\n\n// Start the server\nstartServer();\n\n// Handle graceful shutdown\nprocess.on('SIGINT', () => {\n  console.error('Received SIGINT, shutting down gracefully...');\n  process.exit(0);\n});\n\nprocess.on('SIGTERM', () => {\n  console.error('Received SIGTERM, shutting down gracefully...');\n  process.exit(0);\n});\n"],"version":3}